{"cells":[{"cell_type":"markdown","source":["#**Diplomatura en Ciencia de Datos, Aprendizaje Automático y sus Aplicaciones**\n","\n","##**Edición 2022**\n","\n","#Trabajo práctico entregable - Parte 2\n","**GRUPO 17**\n","\n","**Conrrero, Agustina**\n","\n","**Sanchez Herrera, Carlos**\n","\n","**Serrantes, Sebastian**"],"metadata":{"id":"0-Q8FNGLTN0b"}},{"cell_type":"markdown","metadata":{"id":"6dbOLVpLXrm_"},"source":["# Laboratorio 2: Armado de un esquema de aprendizaje automático\n","\n","En el laboratorio final se espera que puedan poner en práctica los conocimientos adquiridos en el curso, trabajando con un conjunto de datos de clasificación.\n","\n","El objetivo es que se introduzcan en el desarrollo de un esquema para hacer tareas de aprendizaje automático: selección de un modelo, ajuste de hiperparámetros y evaluación.\n","\n","El conjunto de datos a utilizar está en `./data/loan_data.csv`. Si abren el archivo verán que al principio (las líneas que empiezan con `#`) describen el conjunto de datos y sus atributos (incluyendo el atributo de etiqueta o clase).\n","\n","Se espera que hagan uso de las herramientas vistas en el curso. Se espera que hagan uso especialmente de las herramientas brindadas por `scikit-learn`."]},{"cell_type":"code","execution_count":null,"metadata":{"id":"92_7gpZzXrnK"},"outputs":[],"source":["import numpy as np\n","import pandas as pd\n","import seaborn as sns\n","import matplotlib.pyplot as plt\n","\n","# TODO: Agregar las librerías que hagan falta\n","from sklearn.model_selection import train_test_split\n","from sklearn.model_selection import train_test_split, GridSearchCV\n","from sklearn.linear_model import SGDClassifier\n","from sklearn.tree import DecisionTreeClassifier\n","from sklearn.metrics import accuracy_score\n","from sklearn.metrics import precision_score\n","from sklearn.metrics import recall_score\n","from sklearn.metrics import f1_score\n","from sklearn.metrics import classification_report\n","from sklearn.metrics import confusion_matrix\n","from sklearn.model_selection import ParameterGrid\n","from sklearn.model_selection import GridSearchCV\n","from sklearn.tree import plot_tree\n","from sklearn.pipeline import make_pipeline\n","from sklearn.preprocessing import MinMaxScaler\n","from sklearn.pipeline import Pipeline\n","from sklearn.calibration import CalibratedClassifierCV\n","from sklearn.metrics import roc_curve,auc\n","\n","from IPython.display import Image\n","from IPython.core.display import HTML"]},{"cell_type":"markdown","metadata":{"id":"o-67odZXXrnX"},"source":["## Carga de datos y división en entrenamiento y evaluación\n","\n","La celda siguiente se encarga de la carga de datos (haciendo uso de pandas). Estos serán los que se trabajarán en el resto del laboratorio."]},{"cell_type":"code","source":["# Damos acceso al Drive para importar los archivos con los que vamos a trabajar\n","from google.colab import drive\n","import pandas as pd\n","from google.colab import files \n","\n","drive.mount('/content/drive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"cD365oEGfmy6","executionInfo":{"status":"ok","timestamp":1665532027059,"user_tz":180,"elapsed":35072,"user":{"displayName":"Agustina Conrrero","userId":"09961504917594344859"}},"outputId":"b9d5e1e1-1891-47bb-9e09-a1e0fcf56eb4"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}]},{"cell_type":"code","source":["SHARED_FOLDER_ALIAS = 'DiplomaturaGrupo17'\n","DATASETS_PATH = '/content/drive/MyDrive/' + SHARED_FOLDER_ALIAS + '/IntroML/data/'"],"metadata":{"id":"HjYhTqRjOpRx"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["#!ls {DATASETS_PATH}"],"metadata":{"id":"AiV3japVhnVZ"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# Datos etiquetados\n","path = DATASETS_PATH + 'loan_data.csv'\n","dataset = pd.read_csv (path, comment=\"#\")\n","\n","dataset"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"MpA7GjWf70ht","executionInfo":{"status":"ok","timestamp":1665532028054,"user_tz":180,"elapsed":997,"user":{"displayName":"Agustina Conrrero","userId":"09961504917594344859"}},"outputId":"3af8229f-1d40-43cd-bbaf-f97bf1064bf2"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["      TARGET   LOAN   MORTDUE     VALUE   YOJ  DEROG  DELINQ       CLAGE  \\\n","0          0   4700   88026.0  115506.0   6.0    0.0     0.0  182.248332   \n","1          0  19300   39926.0  101208.0   4.0    0.0     0.0  140.051638   \n","2          0   5700   71556.0   79538.0   2.0    0.0     0.0   92.643085   \n","3          0  13000   44875.0   57713.0   0.0    1.0     0.0  184.990324   \n","4          0  19300   72752.0  106084.0  11.0    0.0     0.0  193.707100   \n","...      ...    ...       ...       ...   ...    ...     ...         ...   \n","1849       1  53400  228236.0  305514.0   6.0    0.0     0.0   11.148069   \n","1850       1  53600  235895.0  299772.0   5.0    0.0     0.0  112.748282   \n","1851       1  53600  208197.0  297280.0   4.0    1.0     1.0  160.485251   \n","1852       1  65500  205156.0  290239.0   2.0    0.0     0.0   98.808206   \n","1853       1  77400   87651.0  224630.0   9.0    0.0     2.0   73.469630   \n","\n","      NINQ  CLNO     DEBTINC  \n","0      0.0  27.0   29.209023  \n","1      0.0  14.0   31.545694  \n","2      0.0  15.0   41.210012  \n","3      1.0  12.0   28.602076  \n","4      1.0  13.0   30.686106  \n","...    ...   ...         ...  \n","1849   0.0   2.0   34.558417  \n","1850   7.0  22.0   44.945929  \n","1851   2.0  29.0   41.646731  \n","1852   1.0  21.0  144.189001  \n","1853   3.0  13.0   40.929793  \n","\n","[1854 rows x 11 columns]"],"text/html":["\n","  <div id=\"df-dcb9b72e-be26-4f0a-92ce-28112a4754e0\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>TARGET</th>\n","      <th>LOAN</th>\n","      <th>MORTDUE</th>\n","      <th>VALUE</th>\n","      <th>YOJ</th>\n","      <th>DEROG</th>\n","      <th>DELINQ</th>\n","      <th>CLAGE</th>\n","      <th>NINQ</th>\n","      <th>CLNO</th>\n","      <th>DEBTINC</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>4700</td>\n","      <td>88026.0</td>\n","      <td>115506.0</td>\n","      <td>6.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>182.248332</td>\n","      <td>0.0</td>\n","      <td>27.0</td>\n","      <td>29.209023</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>19300</td>\n","      <td>39926.0</td>\n","      <td>101208.0</td>\n","      <td>4.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>140.051638</td>\n","      <td>0.0</td>\n","      <td>14.0</td>\n","      <td>31.545694</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>5700</td>\n","      <td>71556.0</td>\n","      <td>79538.0</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>92.643085</td>\n","      <td>0.0</td>\n","      <td>15.0</td>\n","      <td>41.210012</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>13000</td>\n","      <td>44875.0</td>\n","      <td>57713.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>184.990324</td>\n","      <td>1.0</td>\n","      <td>12.0</td>\n","      <td>28.602076</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>19300</td>\n","      <td>72752.0</td>\n","      <td>106084.0</td>\n","      <td>11.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>193.707100</td>\n","      <td>1.0</td>\n","      <td>13.0</td>\n","      <td>30.686106</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>1849</th>\n","      <td>1</td>\n","      <td>53400</td>\n","      <td>228236.0</td>\n","      <td>305514.0</td>\n","      <td>6.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>11.148069</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","      <td>34.558417</td>\n","    </tr>\n","    <tr>\n","      <th>1850</th>\n","      <td>1</td>\n","      <td>53600</td>\n","      <td>235895.0</td>\n","      <td>299772.0</td>\n","      <td>5.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>112.748282</td>\n","      <td>7.0</td>\n","      <td>22.0</td>\n","      <td>44.945929</td>\n","    </tr>\n","    <tr>\n","      <th>1851</th>\n","      <td>1</td>\n","      <td>53600</td>\n","      <td>208197.0</td>\n","      <td>297280.0</td>\n","      <td>4.0</td>\n","      <td>1.0</td>\n","      <td>1.0</td>\n","      <td>160.485251</td>\n","      <td>2.0</td>\n","      <td>29.0</td>\n","      <td>41.646731</td>\n","    </tr>\n","    <tr>\n","      <th>1852</th>\n","      <td>1</td>\n","      <td>65500</td>\n","      <td>205156.0</td>\n","      <td>290239.0</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>98.808206</td>\n","      <td>1.0</td>\n","      <td>21.0</td>\n","      <td>144.189001</td>\n","    </tr>\n","    <tr>\n","      <th>1853</th>\n","      <td>1</td>\n","      <td>77400</td>\n","      <td>87651.0</td>\n","      <td>224630.0</td>\n","      <td>9.0</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","      <td>73.469630</td>\n","      <td>3.0</td>\n","      <td>13.0</td>\n","      <td>40.929793</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>1854 rows × 11 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-dcb9b72e-be26-4f0a-92ce-28112a4754e0')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-dcb9b72e-be26-4f0a-92ce-28112a4754e0 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-dcb9b72e-be26-4f0a-92ce-28112a4754e0');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":5}]},{"cell_type":"code","execution_count":null,"metadata":{"id":"INkYxNMHXrna"},"outputs":[],"source":["\n","# División entre instancias y etiquetas\n","X, y = dataset.iloc[:, 1:], dataset.TARGET\n","\n","# división entre entrenamiento y evaluación\n","X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"l1d_sqAgXrnc","outputId":"222eeca2-2762-4901-b596-d3a169cfda41","colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"status":"ok","timestamp":1665532028055,"user_tz":180,"elapsed":16,"user":{"displayName":"Agustina Conrrero","userId":"09961504917594344859"}}},"outputs":[{"output_type":"execute_result","data":{"text/plain":["   TARGET   LOAN  MORTDUE     VALUE   YOJ  DEROG  DELINQ       CLAGE  NINQ  \\\n","0       0   4700  88026.0  115506.0   6.0    0.0     0.0  182.248332   0.0   \n","1       0  19300  39926.0  101208.0   4.0    0.0     0.0  140.051638   0.0   \n","2       0   5700  71556.0   79538.0   2.0    0.0     0.0   92.643085   0.0   \n","3       0  13000  44875.0   57713.0   0.0    1.0     0.0  184.990324   1.0   \n","4       0  19300  72752.0  106084.0  11.0    0.0     0.0  193.707100   1.0   \n","\n","   CLNO    DEBTINC  \n","0  27.0  29.209023  \n","1  14.0  31.545694  \n","2  15.0  41.210012  \n","3  12.0  28.602076  \n","4  13.0  30.686106  "],"text/html":["\n","  <div id=\"df-1b1471db-40cd-4d53-b070-43be564a29be\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>TARGET</th>\n","      <th>LOAN</th>\n","      <th>MORTDUE</th>\n","      <th>VALUE</th>\n","      <th>YOJ</th>\n","      <th>DEROG</th>\n","      <th>DELINQ</th>\n","      <th>CLAGE</th>\n","      <th>NINQ</th>\n","      <th>CLNO</th>\n","      <th>DEBTINC</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>4700</td>\n","      <td>88026.0</td>\n","      <td>115506.0</td>\n","      <td>6.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>182.248332</td>\n","      <td>0.0</td>\n","      <td>27.0</td>\n","      <td>29.209023</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>19300</td>\n","      <td>39926.0</td>\n","      <td>101208.0</td>\n","      <td>4.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>140.051638</td>\n","      <td>0.0</td>\n","      <td>14.0</td>\n","      <td>31.545694</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>5700</td>\n","      <td>71556.0</td>\n","      <td>79538.0</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>92.643085</td>\n","      <td>0.0</td>\n","      <td>15.0</td>\n","      <td>41.210012</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>13000</td>\n","      <td>44875.0</td>\n","      <td>57713.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>184.990324</td>\n","      <td>1.0</td>\n","      <td>12.0</td>\n","      <td>28.602076</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>19300</td>\n","      <td>72752.0</td>\n","      <td>106084.0</td>\n","      <td>11.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>193.707100</td>\n","      <td>1.0</td>\n","      <td>13.0</td>\n","      <td>30.686106</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-1b1471db-40cd-4d53-b070-43be564a29be')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-1b1471db-40cd-4d53-b070-43be564a29be button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-1b1471db-40cd-4d53-b070-43be564a29be');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":7}],"source":["dataset.head()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_2ffwMZ4Xrni","outputId":"c53687ff-119c-4414-e23c-302123ef9293","colab":{"base_uri":"https://localhost:8080/","height":300},"executionInfo":{"status":"ok","timestamp":1665532028055,"user_tz":180,"elapsed":13,"user":{"displayName":"Agustina Conrrero","userId":"09961504917594344859"}}},"outputs":[{"output_type":"execute_result","data":{"text/plain":["            TARGET          LOAN        MORTDUE          VALUE          YOJ  \\\n","count  1854.000000   1854.000000    1854.000000    1854.000000  1854.000000   \n","mean      0.166667  19111.758360   76316.051780  107321.088457     8.900216   \n","std       0.372779  11000.345961   46227.026585   56039.685066     7.552677   \n","min       0.000000   1700.000000    5627.000000   21144.000000     0.000000   \n","25%       0.000000  12000.000000   48984.750000   70787.250000     3.000000   \n","50%       0.000000  17000.000000   67201.000000   94198.000000     7.000000   \n","75%       0.000000  23900.000000   93731.500000  122976.250000    13.000000   \n","max       1.000000  89800.000000  399412.000000  512650.000000    41.000000   \n","\n","             DEROG       DELINQ        CLAGE         NINQ         CLNO  \\\n","count  1854.000000  1854.000000  1854.000000  1854.000000  1854.000000   \n","mean      0.187702     0.319849   180.300783     1.128910    21.857066   \n","std       0.704882     0.928452    84.838308     1.664555     9.510840   \n","min       0.000000     0.000000     0.486711     0.000000     0.000000   \n","25%       0.000000     0.000000   116.970718     0.000000    16.000000   \n","50%       0.000000     0.000000   174.967815     1.000000    21.000000   \n","75%       0.000000     0.000000   232.261800     2.000000    27.000000   \n","max      10.000000    10.000000  1168.233561    13.000000    65.000000   \n","\n","           DEBTINC  \n","count  1854.000000  \n","mean     34.573408  \n","std       9.308794  \n","min       0.838118  \n","25%      29.427210  \n","50%      35.363407  \n","75%      39.357987  \n","max     144.189001  "],"text/html":["\n","  <div id=\"df-5a37d0e0-5f42-46c5-8f5d-ad7b9c417968\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>TARGET</th>\n","      <th>LOAN</th>\n","      <th>MORTDUE</th>\n","      <th>VALUE</th>\n","      <th>YOJ</th>\n","      <th>DEROG</th>\n","      <th>DELINQ</th>\n","      <th>CLAGE</th>\n","      <th>NINQ</th>\n","      <th>CLNO</th>\n","      <th>DEBTINC</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>count</th>\n","      <td>1854.000000</td>\n","      <td>1854.000000</td>\n","      <td>1854.000000</td>\n","      <td>1854.000000</td>\n","      <td>1854.000000</td>\n","      <td>1854.000000</td>\n","      <td>1854.000000</td>\n","      <td>1854.000000</td>\n","      <td>1854.000000</td>\n","      <td>1854.000000</td>\n","      <td>1854.000000</td>\n","    </tr>\n","    <tr>\n","      <th>mean</th>\n","      <td>0.166667</td>\n","      <td>19111.758360</td>\n","      <td>76316.051780</td>\n","      <td>107321.088457</td>\n","      <td>8.900216</td>\n","      <td>0.187702</td>\n","      <td>0.319849</td>\n","      <td>180.300783</td>\n","      <td>1.128910</td>\n","      <td>21.857066</td>\n","      <td>34.573408</td>\n","    </tr>\n","    <tr>\n","      <th>std</th>\n","      <td>0.372779</td>\n","      <td>11000.345961</td>\n","      <td>46227.026585</td>\n","      <td>56039.685066</td>\n","      <td>7.552677</td>\n","      <td>0.704882</td>\n","      <td>0.928452</td>\n","      <td>84.838308</td>\n","      <td>1.664555</td>\n","      <td>9.510840</td>\n","      <td>9.308794</td>\n","    </tr>\n","    <tr>\n","      <th>min</th>\n","      <td>0.000000</td>\n","      <td>1700.000000</td>\n","      <td>5627.000000</td>\n","      <td>21144.000000</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.486711</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.838118</td>\n","    </tr>\n","    <tr>\n","      <th>25%</th>\n","      <td>0.000000</td>\n","      <td>12000.000000</td>\n","      <td>48984.750000</td>\n","      <td>70787.250000</td>\n","      <td>3.000000</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>116.970718</td>\n","      <td>0.000000</td>\n","      <td>16.000000</td>\n","      <td>29.427210</td>\n","    </tr>\n","    <tr>\n","      <th>50%</th>\n","      <td>0.000000</td>\n","      <td>17000.000000</td>\n","      <td>67201.000000</td>\n","      <td>94198.000000</td>\n","      <td>7.000000</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>174.967815</td>\n","      <td>1.000000</td>\n","      <td>21.000000</td>\n","      <td>35.363407</td>\n","    </tr>\n","    <tr>\n","      <th>75%</th>\n","      <td>0.000000</td>\n","      <td>23900.000000</td>\n","      <td>93731.500000</td>\n","      <td>122976.250000</td>\n","      <td>13.000000</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>232.261800</td>\n","      <td>2.000000</td>\n","      <td>27.000000</td>\n","      <td>39.357987</td>\n","    </tr>\n","    <tr>\n","      <th>max</th>\n","      <td>1.000000</td>\n","      <td>89800.000000</td>\n","      <td>399412.000000</td>\n","      <td>512650.000000</td>\n","      <td>41.000000</td>\n","      <td>10.000000</td>\n","      <td>10.000000</td>\n","      <td>1168.233561</td>\n","      <td>13.000000</td>\n","      <td>65.000000</td>\n","      <td>144.189001</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-5a37d0e0-5f42-46c5-8f5d-ad7b9c417968')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-5a37d0e0-5f42-46c5-8f5d-ad7b9c417968 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-5a37d0e0-5f42-46c5-8f5d-ad7b9c417968');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":8}],"source":["dataset.describe()"]},{"cell_type":"markdown","metadata":{"id":"Nwi8VMvxXrnk"},"source":["\n","Documentación:\n","\n","- https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html"]},{"cell_type":"markdown","metadata":{"id":"wIKn_azQXrnl"},"source":["## Ejercicio 1: Descripción de los Datos y la Tarea\n","\n","Responder las siguientes preguntas:\n","\n","1. ¿De qué se trata el conjunto de datos?\n","2. ¿Cuál es la variable objetivo que hay que predecir? ¿Qué significado tiene?\n","3. ¿Qué información (atributos) hay disponible para hacer la predicción?\n","4. ¿Qué atributos imagina ud. que son los más determinantes para la predicción?\n","\n","**No hace falta escribir código para responder estas preguntas.**"]},{"cell_type":"markdown","source":["1. El conjunto de datos está obtenido del departamento de créditos de un banco. El mismo contiene información sobre 5960 préstamos para créditos hipotecarios y los datos estan categorizados según hayan caído en default o no.\n","\n","2. La variable a predecir TARGET es de tipo binaria (0-1). Los valores nulos corresponden a aquellos créditos que han sido cnacelados, mientras que los 1 son aquellos que han incumplido. \n","\n","3. Hay 12 atributos disponibles: \n","\n","LOAN: Monto de la solicitud de préstamo\n"," \n","MORTDUE: Monto adeudado de la hipoteca existente\n"," \n","VALUE: Valor de la propiedad actual\n"," \n","YOJ: Años en el trabajo actual\n"," \n","DEROG: Número de informes importantes derogados \n"," \n","DELINQ: Número de líneas de crédito morosas\n"," \n","CLAGE: Antigüedad de la línea comercial más antigua en meses\n"," \n","NINQ: Número de líneas de crédito recientes\n"," \n","CLNO: Número de líneas de crédito\n"," \n","DEBTINC: Relación deuda-ingresos\n","\n","4) Consideramos que los atributos que más podrían ayudar para la predicción son: LOAN,  MORTDUE, DELINQ y DEBTINC\n"],"metadata":{"id":"H1oPVpt2VGPa"}},{"cell_type":"markdown","metadata":{"id":"4Uw6ujV0Xrnm"},"source":["## Ejercicio 2: Predicción con Modelos Lineales\n","\n","En este ejercicio se entrenarán modelos lineales de clasificación para predecir la variable objetivo.\n","\n","Para ello, deberán utilizar la clase SGDClassifier de scikit-learn.\n","\n","Documentación:\n","- https://scikit-learn.org/stable/modules/sgd.html\n","- https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.SGDClassifier.html\n"]},{"cell_type":"markdown","metadata":{"id":"TxJRAyhKXrno"},"source":["### Ejercicio 2.1: SGDClassifier con hiperparámetros por defecto\n","\n","Entrenar y evaluar el clasificador SGDClassifier usando los valores por omisión de scikit-learn para todos los parámetros. Únicamente **fijar la semilla aleatoria** para hacer repetible el experimento.\n","\n","Evaluar sobre el conjunto de **entrenamiento** y sobre el conjunto de **evaluación**, reportando:\n","- Accuracy\n","- Precision\n","- Recall\n","- F1\n","- matriz de confusión"]},{"cell_type":"markdown","source":["#Ejercicio 2:\n","##Visualizacion del conteo de la variable target \n","Como se muestra en el siguiente gráfico, la variable objetivo TARGET se encuentra muy desbalanceada: la mayoría de los datos corresponden a créditos que no entraron en default (valor 0 de la variable TARGET). \n","\n","Por lo tanto, el medir la efectividad del modelo teniendo en cuenta la cantidad de aciertos lleva un sesgo asociado. Es por ello que, tenemos en claro que se deberían evitar los falsos negativos (modelo prediciendo un valor 0 cuando correspondería un 1). \n","\n","Uno de los objetivos será ubicarnos en un punto de la curva ROC que permita optimizar los resultados buscamos. "],"metadata":{"id":"qmxY3EnMQa2u"}},{"cell_type":"code","source":["sns.countplot(dataset.TARGET)\n","plt.title(\"Variable TARGET\")\n","plt.show()  "],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":350},"id":"nBT5P3fwQLCa","executionInfo":{"status":"ok","timestamp":1665532028544,"user_tz":180,"elapsed":501,"user":{"displayName":"Agustina Conrrero","userId":"09961504917594344859"}},"outputId":"e79fba1e-7d48-4b5a-f344-3e5705f87bea"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/seaborn/_decorators.py:43: FutureWarning: Pass the following variable as a keyword arg: x. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.\n","  FutureWarning\n"]},{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 1 Axes>"],"image/png":"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\n"},"metadata":{"needs_background":"light"}}]},{"cell_type":"markdown","source":["##Ajuste del modelo:"],"metadata":{"id":"tInddmusRc-Z"}},{"cell_type":"markdown","source":["Decidimos escalar la variable ya que SGDC es altamente sensible a la escala. Es por ello que, decidimos utilizar MaxMinScaler para tener las variables en el rango 0-1. \n","https://scikit-learn.org/stable/modules/sgd.html#tips-on-practical-use"],"metadata":{"id":"8J2fYnUJR82q"}},{"cell_type":"code","source":["scaler=MinMaxScaler()\n","sgd=SGDClassifier(random_state=0)\n","\n","model = make_pipeline(scaler,sgd)\n","model.fit(X_train, y_train)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"vuu7n_r-RrjH","executionInfo":{"status":"ok","timestamp":1665532028548,"user_tz":180,"elapsed":20,"user":{"displayName":"Agustina Conrrero","userId":"09961504917594344859"}},"outputId":"d51ebaff-43dc-4875-9418-960be8aa34a4"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["Pipeline(steps=[('minmaxscaler', MinMaxScaler()),\n","                ('sgdclassifier', SGDClassifier(random_state=0))])"]},"metadata":{},"execution_count":10}]},{"cell_type":"code","source":["y_train_pred= model.predict(X_train)\n","y_test_pred= model.predict(X_test)\n","\n","print(\"ENTRENAMIENTO\")\n","print(classification_report(y_train, y_train_pred))\n","\n","print(\"TESTEO\")\n","print(classification_report(y_test, y_test_pred))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"A9imRcF2SLfT","executionInfo":{"status":"ok","timestamp":1665532028549,"user_tz":180,"elapsed":20,"user":{"displayName":"Agustina Conrrero","userId":"09961504917594344859"}},"outputId":"74f85b99-29c0-4de3-a527-68665c3e05d6"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["ENTRENAMIENTO\n","              precision    recall  f1-score   support\n","\n","           0       0.88      0.98      0.93      1232\n","           1       0.80      0.34      0.48       251\n","\n","    accuracy                           0.87      1483\n","   macro avg       0.84      0.66      0.70      1483\n","weighted avg       0.87      0.87      0.85      1483\n","\n","TESTEO\n","              precision    recall  f1-score   support\n","\n","           0       0.89      0.98      0.93       313\n","           1       0.74      0.34      0.47        58\n","\n","    accuracy                           0.88       371\n","   macro avg       0.82      0.66      0.70       371\n","weighted avg       0.87      0.88      0.86       371\n","\n"]}]},{"cell_type":"code","source":["\n","cm=confusion_matrix(y_test,y_test_pred)\n","\n","sns.heatmap(cm, annot=True)\n","\n","plt.title(\"Confusion matrix\")     \n","plt.show()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":281},"id":"3U_5fcpklr-K","executionInfo":{"status":"ok","timestamp":1665532028549,"user_tz":180,"elapsed":17,"user":{"displayName":"Agustina Conrrero","userId":"09961504917594344859"}},"outputId":"ba2d3391-f8d5-4590-f762-b84a239a5717"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 2 Axes>"],"image/png":"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\n"},"metadata":{"needs_background":"light"}}]},{"cell_type":"markdown","source":["Como se muestra anteriormente, estamos en presencia de un caso de alta precisión y bajo recall para la clase 1. Esto significa que, el modelo no predecirá adecuadamente la clase 1 en la totalidad de los casos, pero que, cuando lo haga, lo hará con alta eficacia. \n","Sin embargo, el modelo precedirá correctamente la clase 0. \n","\n","\n","Esto puede ser debido al desbalance de las clases visto en el punto anterior. Para ello, se pueden implementar estrategias de balanceo como oversampling y undersampling."],"metadata":{"id":"yTJlz6hFRubb"}},{"cell_type":"markdown","source":["### Balanceo de las clases\n"],"metadata":{"id":"d4IQa55wa7yW"}},{"cell_type":"markdown","source":["Debido a que las clases de la variable target estan muy desbalanceadas, se decidió probar con un balanceador de clases `class_weight=’balanced’` como hiperparámetro del modelo: "],"metadata":{"id":"ZaZv7GTFbHB3"}},{"cell_type":"code","source":["scaler=MinMaxScaler()\n","sgd=SGDClassifier(random_state=0, class_weight='balanced')\n","\n","model = make_pipeline(scaler,sgd)\n","model.fit(X_train, y_train)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1665532327585,"user_tz":180,"elapsed":275,"user":{"displayName":"Agustina Conrrero","userId":"09961504917594344859"}},"outputId":"650cdec3-d801-4954-da76-536b9d0a05b5","id":"qjeZ8Ng8bCKe"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["Pipeline(steps=[('minmaxscaler', MinMaxScaler()),\n","                ('sgdclassifier',\n","                 SGDClassifier(class_weight='balanced', random_state=0))])"]},"metadata":{},"execution_count":14}]},{"cell_type":"code","source":["y_train_pred= model.predict(X_train)\n","y_test_pred= model.predict(X_test)\n","\n","print(\"ENTRENAMIENTO\")\n","print(classification_report(y_train, y_train_pred))\n","\n","print(\"TESTEO\")\n","print(classification_report(y_test, y_test_pred))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1665532330154,"user_tz":180,"elapsed":3,"user":{"displayName":"Agustina Conrrero","userId":"09961504917594344859"}},"outputId":"62f75441-9b1f-4cba-9b88-c5ffbd7f7e87","id":"qYtoSZ3fbCKf"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["ENTRENAMIENTO\n","              precision    recall  f1-score   support\n","\n","           0       0.89      0.96      0.92      1232\n","           1       0.67      0.44      0.53       251\n","\n","    accuracy                           0.87      1483\n","   macro avg       0.78      0.70      0.73      1483\n","weighted avg       0.86      0.87      0.86      1483\n","\n","TESTEO\n","              precision    recall  f1-score   support\n","\n","           0       0.90      0.96      0.93       313\n","           1       0.67      0.41      0.51        58\n","\n","    accuracy                           0.88       371\n","   macro avg       0.78      0.69      0.72       371\n","weighted avg       0.86      0.88      0.86       371\n","\n"]}]},{"cell_type":"code","source":["\n","cm=confusion_matrix(y_test,y_test_pred)\n","\n","sns.heatmap(cm, annot=True)\n","\n","plt.title(\"Confusion matrix\")     \n","plt.show()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":281},"executionInfo":{"status":"ok","timestamp":1665532333644,"user_tz":180,"elapsed":319,"user":{"displayName":"Agustina Conrrero","userId":"09961504917594344859"}},"outputId":"e485fade-36c9-4752-dd81-3e3f67b0ff95","id":"cGaqVCIebCKf"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 2 Axes>"],"image/png":"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\n"},"metadata":{"needs_background":"light"}}]},{"cell_type":"markdown","source":["El balanceo de clases mejoró la predicción, lo cual se puede ver reflejado en valores más altos de las métricas del classification report y de la matriz de confusión."],"metadata":{"id":"jqvocnNEd4rE"}},{"cell_type":"markdown","metadata":{"id":"Ti2SeE4WXrnq"},"source":["### Ejercicio 2.2: Ajuste de Hiperparámetros\n","\n","Seleccionar valores para los hiperparámetros principales del SGDClassifier. Como mínimo, probar diferentes funciones de loss, tasas de entrenamiento y tasas de regularización.\n","\n","Para ello, usar grid-search y 5-fold cross-validation sobre el conjunto de entrenamiento para explorar muchas combinaciones posibles de valores.\n","\n","Reportar accuracy promedio y varianza para todas las configuraciones.\n","\n","Para la mejor configuración encontrada, evaluar sobre el conjunto de **entrenamiento** y sobre el conjunto de **evaluación**, reportando:\n","- Accuracy\n","- Precision\n","- Recall\n","- F1\n","- matriz de confusión\n","\n","Documentación:\n","- https://scikit-learn.org/stable/modules/grid_search.html\n","- https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html"]},{"cell_type":"code","source":["parameters={'sgd__loss':['hinge', 'log', 'modified_huber', 'squared_hinge', 'perceptron'],\n","        'sgd__alpha':[0.0001, 0.001, 0.01, 0.1, 1, 10, 100],\n","        'sgd__penalty':['l1','l2']}"],"metadata":{"id":"_Xk6WSZrxi9k"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["Realizamos una validación cruzada con el modelo de descenso de gradiente y la grilla de hiperparámetros. A su vez, utilizamos el parámetro \"class weight\" de SGD Classifier para balancear el dataset durante el entrenamiento. "],"metadata":{"id":"Ik5bN27Zx7Q_"}},{"cell_type":"markdown","source":["A su vez, cambiamos la metrica seleccionada por defecto, accuracy, ya que al tratarse de un dataset desbalanceado en la variable objetivo, no se trata de la mejor métrica para evaluar la eficacia de la predicción del modelo. Es por ello que, elegimos \"balanced accuracy score\".\n","\n"],"metadata":{"id":"ArnSluc2yLLS"}},{"cell_type":"markdown","source":["\"Empíricamente, encontramos que SGD converge después de observar aproximadamente 10 ^ 6 muestras de entrenamiento. Por lo tanto, una primera estimación razonable del número de iteraciones es max_iter = np.ceil (10 ** 6 / n), donde n es el tamaño del conjunto de entrenamiento.\"\n","\n","https://scikit-learn.org/stable/modules/sgd.html#tips-on-practical-use"],"metadata":{"id":"lOnQQcCrywTv"}},{"cell_type":"code","source":["max_iter=np.ceil(10**6 / X_train.shape[0])"],"metadata":{"id":"g6N3qTLgy8Z3"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"nuGb_RpQTULo"},"outputs":[],"source":["scaler=MinMaxScaler()\n","sgd= SGDClassifier(random_state=0,class_weight='balanced',max_iter=max_iter)\n","\n","pipe = Pipeline(steps=[('scaler', scaler), ('sgd', sgd)])\n","\n","cv = GridSearchCV(pipe, parameters, scoring='balanced_accuracy', cv=5,refit=True,n_jobs=-1)     \n","cv.fit(X_train, y_train);"]},{"cell_type":"code","source":["results = cv.cv_results_\n","results"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"yrnVpsrNzHSk","executionInfo":{"status":"ok","timestamp":1665532523017,"user_tz":180,"elapsed":316,"user":{"displayName":"Agustina Conrrero","userId":"09961504917594344859"}},"outputId":"60a43b71-ee52-4ff8-bfc4-b75443016b5a"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'mean_fit_time': array([0.01005492, 0.00967155, 0.01496401, 0.01258883, 0.01693282,\n","        0.01377029, 0.08738675, 0.04622493, 0.01638503, 0.01103082,\n","        0.00756302, 0.00759997, 0.01090584, 0.00918684, 0.01132536,\n","        0.00790391, 0.03069334, 0.03556294, 0.00845771, 0.0072926 ,\n","        0.00739861, 0.00746446, 0.01194143, 0.007234  , 0.00891447,\n","        0.00694199, 0.01563158, 0.06030993, 0.00651708, 0.00579548,\n","        0.00590687, 0.00532284, 0.00683923, 0.00711656, 0.00648532,\n","        0.00612364, 0.03041658, 0.0057642 , 0.005269  , 0.00484476,\n","        0.00736589, 0.00549922, 0.00772624, 0.00867934, 0.00603967,\n","        0.00566902, 0.00893383, 0.00575767, 0.00605927, 0.00864925,\n","        0.00900998, 0.00954509, 0.01051373, 0.00920548, 0.03517666,\n","        0.02189589, 0.01978345, 0.01148415, 0.00831747, 0.01003442,\n","        0.00489998, 0.0052897 , 0.00614986, 0.00767775, 0.01440449,\n","        0.01104875, 0.01428895, 0.01088777, 0.00627971, 0.00582805]),\n"," 'std_fit_time': array([0.00171945, 0.00254143, 0.003585  , 0.00242772, 0.00303339,\n","        0.00459137, 0.01931737, 0.01912319, 0.00342943, 0.00364602,\n","        0.00098952, 0.00062867, 0.00249063, 0.00147016, 0.00302902,\n","        0.00080106, 0.00506535, 0.00649902, 0.00063345, 0.00030618,\n","        0.00055561, 0.00215197, 0.00461158, 0.0006975 , 0.00206846,\n","        0.00047319, 0.00430622, 0.00658447, 0.00022058, 0.0007234 ,\n","        0.00139617, 0.00014655, 0.00037687, 0.00142226, 0.0004316 ,\n","        0.00058988, 0.03018621, 0.00025199, 0.00028709, 0.00026481,\n","        0.0028108 , 0.00071289, 0.00124736, 0.00295778, 0.00012976,\n","        0.0001209 , 0.00285917, 0.0003025 , 0.00026988, 0.00504846,\n","        0.00288138, 0.00548563, 0.00395155, 0.00454512, 0.02443818,\n","        0.01365218, 0.01234384, 0.00567099, 0.00229745, 0.00725332,\n","        0.00024086, 0.0001614 , 0.0001958 , 0.00183207, 0.00623378,\n","        0.0041926 , 0.00686834, 0.004399  , 0.00040988, 0.00023341]),\n"," 'mean_score_time': array([0.00490851, 0.00227385, 0.00276437, 0.00228667, 0.00269079,\n","        0.00265675, 0.0028513 , 0.00277185, 0.00272179, 0.00250816,\n","        0.00237808, 0.00246572, 0.00265689, 0.00249057, 0.00287156,\n","        0.00194354, 0.00256653, 0.00270834, 0.00219502, 0.00230103,\n","        0.00241489, 0.00254698, 0.00337095, 0.0024035 , 0.00243864,\n","        0.00218258, 0.00242648, 0.00269446, 0.00215201, 0.0020452 ,\n","        0.002424  , 0.00218344, 0.00232916, 0.00241547, 0.00216312,\n","        0.00230417, 0.00260363, 0.00203519, 0.00200262, 0.00199013,\n","        0.00225897, 0.00222135, 0.00227933, 0.00242071, 0.00227637,\n","        0.00211968, 0.00241027, 0.0026885 , 0.00351248, 0.00328646,\n","        0.00231047, 0.00219769, 0.00385842, 0.00440111, 0.00249538,\n","        0.00247974, 0.00235906, 0.00202899, 0.00201769, 0.00203938,\n","        0.00190482, 0.00214715, 0.00224056, 0.0021009 , 0.00322914,\n","        0.00240188, 0.00245409, 0.00243158, 0.0023231 , 0.00215135]),\n"," 'std_score_time': array([5.16254744e-03, 1.00347137e-04, 8.74544003e-04, 1.84397498e-04,\n","        4.57618536e-04, 2.69558639e-04, 2.45767968e-04, 1.52319060e-04,\n","        8.98807055e-05, 7.65706053e-05, 8.69411059e-05, 4.41750446e-05,\n","        6.53278044e-05, 2.33673532e-04, 4.23170597e-04, 5.47041338e-05,\n","        6.45635399e-05, 6.63073917e-05, 8.70776461e-05, 1.49885127e-04,\n","        2.35243899e-04, 6.95096198e-04, 1.95850666e-03, 7.64405808e-05,\n","        1.41931171e-04, 1.57487309e-04, 1.17416694e-04, 1.18867633e-04,\n","        6.29550387e-05, 1.01646137e-04, 6.80654453e-04, 6.72167898e-05,\n","        1.03021151e-04, 2.61519356e-04, 7.39439608e-05, 1.00294011e-04,\n","        2.37163032e-04, 9.55904974e-05, 5.45616321e-05, 1.20353680e-04,\n","        1.09745333e-04, 1.37241239e-04, 7.71155524e-05, 1.09671966e-04,\n","        5.11518491e-05, 1.04755122e-04, 1.44728962e-04, 6.74564299e-04,\n","        2.57618377e-03, 2.09569348e-03, 1.89303835e-04, 8.89905642e-05,\n","        2.98086899e-03, 3.01380801e-03, 2.65976612e-04, 1.99903161e-04,\n","        3.21115879e-04, 1.60620910e-04, 1.01173946e-04, 1.61392114e-04,\n","        9.88011425e-05, 6.06445015e-05, 7.46863999e-05, 1.54785293e-04,\n","        1.64842009e-03, 2.06187464e-04, 2.01856462e-04, 1.68750804e-04,\n","        3.80919178e-05, 2.74544003e-04]),\n"," 'param_sgd__alpha': masked_array(data=[0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001,\n","                    0.0001, 0.0001, 0.0001, 0.001, 0.001, 0.001, 0.001,\n","                    0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.01, 0.01,\n","                    0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.1,\n","                    0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 1, 1, 1,\n","                    1, 1, 1, 1, 1, 1, 1, 10, 10, 10, 10, 10, 10, 10, 10,\n","                    10, 10, 100, 100, 100, 100, 100, 100, 100, 100, 100,\n","                    100],\n","              mask=[False, False, False, False, False, False, False, False,\n","                    False, False, False, False, False, False, False, False,\n","                    False, False, False, False, False, False, False, False,\n","                    False, False, False, False, False, False, False, False,\n","                    False, False, False, False, False, False, False, False,\n","                    False, False, False, False, False, False, False, False,\n","                    False, False, False, False, False, False, False, False,\n","                    False, False, False, False, False, False, False, False,\n","                    False, False, False, False, False, False],\n","        fill_value='?',\n","             dtype=object),\n"," 'param_sgd__loss': masked_array(data=['hinge', 'hinge', 'log', 'log', 'modified_huber',\n","                    'modified_huber', 'squared_hinge', 'squared_hinge',\n","                    'perceptron', 'perceptron', 'hinge', 'hinge', 'log',\n","                    'log', 'modified_huber', 'modified_huber',\n","                    'squared_hinge', 'squared_hinge', 'perceptron',\n","                    'perceptron', 'hinge', 'hinge', 'log', 'log',\n","                    'modified_huber', 'modified_huber', 'squared_hinge',\n","                    'squared_hinge', 'perceptron', 'perceptron', 'hinge',\n","                    'hinge', 'log', 'log', 'modified_huber',\n","                    'modified_huber', 'squared_hinge', 'squared_hinge',\n","                    'perceptron', 'perceptron', 'hinge', 'hinge', 'log',\n","                    'log', 'modified_huber', 'modified_huber',\n","                    'squared_hinge', 'squared_hinge', 'perceptron',\n","                    'perceptron', 'hinge', 'hinge', 'log', 'log',\n","                    'modified_huber', 'modified_huber', 'squared_hinge',\n","                    'squared_hinge', 'perceptron', 'perceptron', 'hinge',\n","                    'hinge', 'log', 'log', 'modified_huber',\n","                    'modified_huber', 'squared_hinge', 'squared_hinge',\n","                    'perceptron', 'perceptron'],\n","              mask=[False, False, False, False, False, False, False, False,\n","                    False, False, False, False, False, False, False, False,\n","                    False, False, False, False, False, False, False, False,\n","                    False, False, False, False, False, False, False, False,\n","                    False, False, False, False, False, False, False, False,\n","                    False, False, False, False, False, False, False, False,\n","                    False, False, False, False, False, False, False, False,\n","                    False, False, False, False, False, False, False, False,\n","                    False, False, False, False, False, False],\n","        fill_value='?',\n","             dtype=object),\n"," 'param_sgd__penalty': masked_array(data=['l1', 'l2', 'l1', 'l2', 'l1', 'l2', 'l1', 'l2', 'l1',\n","                    'l2', 'l1', 'l2', 'l1', 'l2', 'l1', 'l2', 'l1', 'l2',\n","                    'l1', 'l2', 'l1', 'l2', 'l1', 'l2', 'l1', 'l2', 'l1',\n","                    'l2', 'l1', 'l2', 'l1', 'l2', 'l1', 'l2', 'l1', 'l2',\n","                    'l1', 'l2', 'l1', 'l2', 'l1', 'l2', 'l1', 'l2', 'l1',\n","                    'l2', 'l1', 'l2', 'l1', 'l2', 'l1', 'l2', 'l1', 'l2',\n","                    'l1', 'l2', 'l1', 'l2', 'l1', 'l2', 'l1', 'l2', 'l1',\n","                    'l2', 'l1', 'l2', 'l1', 'l2', 'l1', 'l2'],\n","              mask=[False, False, False, False, False, False, False, False,\n","                    False, False, False, False, False, False, False, False,\n","                    False, False, False, False, False, False, False, False,\n","                    False, False, False, False, False, False, False, False,\n","                    False, False, False, False, False, False, False, False,\n","                    False, False, False, False, False, False, False, False,\n","                    False, False, False, False, False, False, False, False,\n","                    False, False, False, False, False, False, False, False,\n","                    False, False, False, False, False, False],\n","        fill_value='?',\n","             dtype=object),\n"," 'params': [{'sgd__alpha': 0.0001, 'sgd__loss': 'hinge', 'sgd__penalty': 'l1'},\n","  {'sgd__alpha': 0.0001, 'sgd__loss': 'hinge', 'sgd__penalty': 'l2'},\n","  {'sgd__alpha': 0.0001, 'sgd__loss': 'log', 'sgd__penalty': 'l1'},\n","  {'sgd__alpha': 0.0001, 'sgd__loss': 'log', 'sgd__penalty': 'l2'},\n","  {'sgd__alpha': 0.0001, 'sgd__loss': 'modified_huber', 'sgd__penalty': 'l1'},\n","  {'sgd__alpha': 0.0001, 'sgd__loss': 'modified_huber', 'sgd__penalty': 'l2'},\n","  {'sgd__alpha': 0.0001, 'sgd__loss': 'squared_hinge', 'sgd__penalty': 'l1'},\n","  {'sgd__alpha': 0.0001, 'sgd__loss': 'squared_hinge', 'sgd__penalty': 'l2'},\n","  {'sgd__alpha': 0.0001, 'sgd__loss': 'perceptron', 'sgd__penalty': 'l1'},\n","  {'sgd__alpha': 0.0001, 'sgd__loss': 'perceptron', 'sgd__penalty': 'l2'},\n","  {'sgd__alpha': 0.001, 'sgd__loss': 'hinge', 'sgd__penalty': 'l1'},\n","  {'sgd__alpha': 0.001, 'sgd__loss': 'hinge', 'sgd__penalty': 'l2'},\n","  {'sgd__alpha': 0.001, 'sgd__loss': 'log', 'sgd__penalty': 'l1'},\n","  {'sgd__alpha': 0.001, 'sgd__loss': 'log', 'sgd__penalty': 'l2'},\n","  {'sgd__alpha': 0.001, 'sgd__loss': 'modified_huber', 'sgd__penalty': 'l1'},\n","  {'sgd__alpha': 0.001, 'sgd__loss': 'modified_huber', 'sgd__penalty': 'l2'},\n","  {'sgd__alpha': 0.001, 'sgd__loss': 'squared_hinge', 'sgd__penalty': 'l1'},\n","  {'sgd__alpha': 0.001, 'sgd__loss': 'squared_hinge', 'sgd__penalty': 'l2'},\n","  {'sgd__alpha': 0.001, 'sgd__loss': 'perceptron', 'sgd__penalty': 'l1'},\n","  {'sgd__alpha': 0.001, 'sgd__loss': 'perceptron', 'sgd__penalty': 'l2'},\n","  {'sgd__alpha': 0.01, 'sgd__loss': 'hinge', 'sgd__penalty': 'l1'},\n","  {'sgd__alpha': 0.01, 'sgd__loss': 'hinge', 'sgd__penalty': 'l2'},\n","  {'sgd__alpha': 0.01, 'sgd__loss': 'log', 'sgd__penalty': 'l1'},\n","  {'sgd__alpha': 0.01, 'sgd__loss': 'log', 'sgd__penalty': 'l2'},\n","  {'sgd__alpha': 0.01, 'sgd__loss': 'modified_huber', 'sgd__penalty': 'l1'},\n","  {'sgd__alpha': 0.01, 'sgd__loss': 'modified_huber', 'sgd__penalty': 'l2'},\n","  {'sgd__alpha': 0.01, 'sgd__loss': 'squared_hinge', 'sgd__penalty': 'l1'},\n","  {'sgd__alpha': 0.01, 'sgd__loss': 'squared_hinge', 'sgd__penalty': 'l2'},\n","  {'sgd__alpha': 0.01, 'sgd__loss': 'perceptron', 'sgd__penalty': 'l1'},\n","  {'sgd__alpha': 0.01, 'sgd__loss': 'perceptron', 'sgd__penalty': 'l2'},\n","  {'sgd__alpha': 0.1, 'sgd__loss': 'hinge', 'sgd__penalty': 'l1'},\n","  {'sgd__alpha': 0.1, 'sgd__loss': 'hinge', 'sgd__penalty': 'l2'},\n","  {'sgd__alpha': 0.1, 'sgd__loss': 'log', 'sgd__penalty': 'l1'},\n","  {'sgd__alpha': 0.1, 'sgd__loss': 'log', 'sgd__penalty': 'l2'},\n","  {'sgd__alpha': 0.1, 'sgd__loss': 'modified_huber', 'sgd__penalty': 'l1'},\n","  {'sgd__alpha': 0.1, 'sgd__loss': 'modified_huber', 'sgd__penalty': 'l2'},\n","  {'sgd__alpha': 0.1, 'sgd__loss': 'squared_hinge', 'sgd__penalty': 'l1'},\n","  {'sgd__alpha': 0.1, 'sgd__loss': 'squared_hinge', 'sgd__penalty': 'l2'},\n","  {'sgd__alpha': 0.1, 'sgd__loss': 'perceptron', 'sgd__penalty': 'l1'},\n","  {'sgd__alpha': 0.1, 'sgd__loss': 'perceptron', 'sgd__penalty': 'l2'},\n","  {'sgd__alpha': 1, 'sgd__loss': 'hinge', 'sgd__penalty': 'l1'},\n","  {'sgd__alpha': 1, 'sgd__loss': 'hinge', 'sgd__penalty': 'l2'},\n","  {'sgd__alpha': 1, 'sgd__loss': 'log', 'sgd__penalty': 'l1'},\n","  {'sgd__alpha': 1, 'sgd__loss': 'log', 'sgd__penalty': 'l2'},\n","  {'sgd__alpha': 1, 'sgd__loss': 'modified_huber', 'sgd__penalty': 'l1'},\n","  {'sgd__alpha': 1, 'sgd__loss': 'modified_huber', 'sgd__penalty': 'l2'},\n","  {'sgd__alpha': 1, 'sgd__loss': 'squared_hinge', 'sgd__penalty': 'l1'},\n","  {'sgd__alpha': 1, 'sgd__loss': 'squared_hinge', 'sgd__penalty': 'l2'},\n","  {'sgd__alpha': 1, 'sgd__loss': 'perceptron', 'sgd__penalty': 'l1'},\n","  {'sgd__alpha': 1, 'sgd__loss': 'perceptron', 'sgd__penalty': 'l2'},\n","  {'sgd__alpha': 10, 'sgd__loss': 'hinge', 'sgd__penalty': 'l1'},\n","  {'sgd__alpha': 10, 'sgd__loss': 'hinge', 'sgd__penalty': 'l2'},\n","  {'sgd__alpha': 10, 'sgd__loss': 'log', 'sgd__penalty': 'l1'},\n","  {'sgd__alpha': 10, 'sgd__loss': 'log', 'sgd__penalty': 'l2'},\n","  {'sgd__alpha': 10, 'sgd__loss': 'modified_huber', 'sgd__penalty': 'l1'},\n","  {'sgd__alpha': 10, 'sgd__loss': 'modified_huber', 'sgd__penalty': 'l2'},\n","  {'sgd__alpha': 10, 'sgd__loss': 'squared_hinge', 'sgd__penalty': 'l1'},\n","  {'sgd__alpha': 10, 'sgd__loss': 'squared_hinge', 'sgd__penalty': 'l2'},\n","  {'sgd__alpha': 10, 'sgd__loss': 'perceptron', 'sgd__penalty': 'l1'},\n","  {'sgd__alpha': 10, 'sgd__loss': 'perceptron', 'sgd__penalty': 'l2'},\n","  {'sgd__alpha': 100, 'sgd__loss': 'hinge', 'sgd__penalty': 'l1'},\n","  {'sgd__alpha': 100, 'sgd__loss': 'hinge', 'sgd__penalty': 'l2'},\n","  {'sgd__alpha': 100, 'sgd__loss': 'log', 'sgd__penalty': 'l1'},\n","  {'sgd__alpha': 100, 'sgd__loss': 'log', 'sgd__penalty': 'l2'},\n","  {'sgd__alpha': 100, 'sgd__loss': 'modified_huber', 'sgd__penalty': 'l1'},\n","  {'sgd__alpha': 100, 'sgd__loss': 'modified_huber', 'sgd__penalty': 'l2'},\n","  {'sgd__alpha': 100, 'sgd__loss': 'squared_hinge', 'sgd__penalty': 'l1'},\n","  {'sgd__alpha': 100, 'sgd__loss': 'squared_hinge', 'sgd__penalty': 'l2'},\n","  {'sgd__alpha': 100, 'sgd__loss': 'perceptron', 'sgd__penalty': 'l1'},\n","  {'sgd__alpha': 100, 'sgd__loss': 'perceptron', 'sgd__penalty': 'l2'}],\n"," 'split0_test_score': array([0.67376518, 0.65720648, 0.65793522, 0.67817814, 0.681417  ,\n","        0.71461538, 0.66781377, 0.6791498 , 0.6740081 , 0.68558704,\n","        0.6948583 , 0.68854251, 0.68093117, 0.69295547, 0.67817814,\n","        0.68210526, 0.64246964, 0.62817814, 0.68663968, 0.62785425,\n","        0.68866397, 0.67927126, 0.63008097, 0.68437247, 0.68295547,\n","        0.66995951, 0.68437247, 0.66425101, 0.53785425, 0.68388664,\n","        0.5       , 0.57562753, 0.5       , 0.67437247, 0.5       ,\n","        0.68032389, 0.57805668, 0.68234818, 0.5       , 0.66987854,\n","        0.5       , 0.5       , 0.5       , 0.5       , 0.5       ,\n","        0.64186235, 0.5       , 0.67639676, 0.5       , 0.66975709,\n","        0.5       , 0.5       , 0.5       , 0.5       , 0.5       ,\n","        0.5       , 0.5       , 0.5       , 0.5       , 0.5       ,\n","        0.5       , 0.5       , 0.5       , 0.5       , 0.5       ,\n","        0.5       , 0.5       , 0.5       , 0.5       , 0.5       ]),\n"," 'split1_test_score': array([0.70963563, 0.71165992, 0.65817814, 0.65412955, 0.70259109,\n","        0.57121457, 0.59591093, 0.64530364, 0.57526316, 0.64773279,\n","        0.69951417, 0.68700405, 0.66651822, 0.66449393, 0.68878543,\n","        0.65210526, 0.61591093, 0.59793522, 0.63987854, 0.65744939,\n","        0.71546559, 0.62975709, 0.69319838, 0.67186235, 0.70093117,\n","        0.68068826, 0.65983806, 0.67186235, 0.53048583, 0.70307692,\n","        0.5       , 0.5       , 0.5       , 0.65473684, 0.5       ,\n","        0.66186235, 0.53376518, 0.66388664, 0.5       , 0.67963563,\n","        0.5       , 0.5       , 0.5       , 0.5       , 0.5       ,\n","        0.63995951, 0.5       , 0.67271255, 0.5       , 0.70068826,\n","        0.5       , 0.5       , 0.5       , 0.5       , 0.5       ,\n","        0.5       , 0.5       , 0.5       , 0.5       , 0.5       ,\n","        0.5       , 0.5       , 0.5       , 0.5       , 0.5       ,\n","        0.5       , 0.5       , 0.5       , 0.5       , 0.5       ]),\n"," 'split2_test_score': array([0.57352941, 0.66965567, 0.71138211, 0.71054519, 0.6013869 ,\n","        0.64478718, 0.63283118, 0.69356767, 0.62135342, 0.6480153 ,\n","        0.7236968 , 0.71186035, 0.69954567, 0.69476327, 0.70361071,\n","        0.70325203, 0.64167862, 0.63354854, 0.5       , 0.54507413,\n","        0.64598278, 0.62266858, 0.62697274, 0.69117647, 0.69452415,\n","        0.70229555, 0.70636059, 0.72357724, 0.5       , 0.50203252,\n","        0.5       , 0.5       , 0.5       , 0.68806791, 0.5       ,\n","        0.69117647, 0.60473458, 0.67527499, 0.5       , 0.61860354,\n","        0.5       , 0.5       , 0.5       , 0.5       , 0.5       ,\n","        0.67407939, 0.5       , 0.67384027, 0.5       , 0.68890483,\n","        0.5       , 0.5       , 0.5       , 0.5       , 0.5       ,\n","        0.5       , 0.5       , 0.5       , 0.5       , 0.5       ,\n","        0.5       , 0.5       , 0.5       , 0.5       , 0.5       ,\n","        0.5       , 0.5       , 0.5       , 0.5       , 0.5       ]),\n"," 'split3_test_score': array([0.7495122 , 0.76357724, 0.74715447, 0.74528455, 0.63430894,\n","        0.66796748, 0.74747967, 0.7495122 , 0.5       , 0.53455285,\n","        0.77447154, 0.7296748 , 0.74699187, 0.74121951, 0.75934959,\n","        0.75138211, 0.69333333, 0.68617886, 0.56      , 0.5003252 ,\n","        0.64186992, 0.64186992, 0.61089431, 0.74699187, 0.75715447,\n","        0.73934959, 0.70365854, 0.63504065, 0.5       , 0.69764228,\n","        0.5       , 0.64577236, 0.5       , 0.71105691, 0.59186992,\n","        0.73902439, 0.59089431, 0.74105691, 0.5       , 0.63390244,\n","        0.5       , 0.5       , 0.5       , 0.73178862, 0.5       ,\n","        0.70699187, 0.5       , 0.70699187, 0.5       , 0.5       ,\n","        0.5       , 0.5       , 0.5       , 0.5       , 0.5       ,\n","        0.5       , 0.5       , 0.5       , 0.5       , 0.61650407,\n","        0.5       , 0.5       , 0.5       , 0.5       , 0.5       ,\n","        0.5       , 0.5       , 0.5       , 0.5       , 0.5       ]),\n"," 'split4_test_score': array([0.71601626, 0.76585366, 0.7402439 , 0.75382114, 0.73650407,\n","        0.73056911, 0.64821138, 0.60154472, 0.68471545, 0.58796748,\n","        0.69325203, 0.70138211, 0.71105691, 0.69715447, 0.72243902,\n","        0.72666667, 0.69756098, 0.6699187 , 0.50203252, 0.50203252,\n","        0.5996748 , 0.6398374 , 0.63495935, 0.67853659, 0.68105691,\n","        0.68934959, 0.71414634, 0.67349593, 0.52      , 0.6896748 ,\n","        0.5       , 0.62772358, 0.5       , 0.63837398, 0.5       ,\n","        0.66853659, 0.63682927, 0.66650407, 0.5       , 0.59593496,\n","        0.5       , 0.5       , 0.5       , 0.52      , 0.5       ,\n","        0.63837398, 0.5       , 0.63837398, 0.5       , 0.61577236,\n","        0.5       , 0.5       , 0.5       , 0.5       , 0.5       ,\n","        0.5       , 0.5       , 0.5       , 0.5       , 0.65170732,\n","        0.5       , 0.5       , 0.5       , 0.5       , 0.5       ,\n","        0.5       , 0.5       , 0.5       , 0.5       , 0.5       ]),\n"," 'mean_test_score': array([0.68449174, 0.71359059, 0.70297877, 0.70839172, 0.6712416 ,\n","        0.66583075, 0.65844939, 0.6738156 , 0.61106802, 0.62077109,\n","        0.71715857, 0.70369276, 0.70100877, 0.69811733, 0.71047258,\n","        0.70310227, 0.6581907 , 0.64315189, 0.57771015, 0.5665471 ,\n","        0.65833141, 0.64268085, 0.63922115, 0.69458795, 0.70332443,\n","        0.6963285 , 0.6936752 , 0.67364544, 0.51766802, 0.65526263,\n","        0.5       , 0.56982469, 0.5       , 0.67332162, 0.51837398,\n","        0.68818474, 0.588856  , 0.68581416, 0.5       , 0.63959102,\n","        0.5       , 0.5       , 0.5       , 0.55035772, 0.5       ,\n","        0.66025342, 0.5       , 0.67366309, 0.5       , 0.63502451,\n","        0.5       , 0.5       , 0.5       , 0.5       , 0.5       ,\n","        0.5       , 0.5       , 0.5       , 0.5       , 0.55364228,\n","        0.5       , 0.5       , 0.5       , 0.5       , 0.5       ,\n","        0.5       , 0.5       , 0.5       , 0.5       , 0.5       ]),\n"," 'std_test_score': array([0.06046713, 0.04548245, 0.03859227, 0.03817537, 0.04814399,\n","        0.05651657, 0.05037113, 0.04936514, 0.06798423, 0.05325402,\n","        0.03068444, 0.01584398, 0.02760529, 0.0246055 , 0.02860946,\n","        0.03443201, 0.03191364, 0.03139671, 0.07457905, 0.06485423,\n","        0.04012093, 0.01957097, 0.02816977, 0.02696763, 0.02789833,\n","        0.02397943, 0.01955069, 0.0285481 , 0.01550185, 0.07689634,\n","        0.        , 0.0614898 , 0.        , 0.02533472, 0.03674797,\n","        0.02732886, 0.03379154, 0.02838501, 0.        , 0.03130364,\n","        0.        , 0.        , 0.        , 0.09104555, 0.        ,\n","        0.0268493 , 0.        , 0.02174643, 0.        , 0.07351657,\n","        0.        , 0.        , 0.        , 0.        , 0.        ,\n","        0.        , 0.        , 0.        , 0.        , 0.06663458,\n","        0.        , 0.        , 0.        , 0.        , 0.        ,\n","        0.        , 0.        , 0.        , 0.        , 0.        ]),\n"," 'rank_test_score': array([16,  2,  8,  4, 21, 22, 24, 17, 34, 33,  1,  5,  9, 10,  3,  7, 26,\n","        28, 36, 38, 25, 29, 31, 12,  6, 11, 13, 19, 42, 27, 43, 37, 43, 20,\n","        41, 14, 35, 15, 43, 30, 43, 43, 43, 40, 43, 23, 43, 18, 43, 32, 43,\n","        43, 43, 43, 43, 43, 43, 43, 43, 39, 43, 43, 43, 43, 43, 43, 43, 43,\n","        43, 43], dtype=int32)}"]},"metadata":{},"execution_count":20}]},{"cell_type":"code","source":["cv.best_estimator_"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"I2TGTUXpzOzG","executionInfo":{"status":"ok","timestamp":1665532525998,"user_tz":180,"elapsed":2,"user":{"displayName":"Agustina Conrrero","userId":"09961504917594344859"}},"outputId":"09ae202f-c6c1-47f4-ca9e-6ac6f4442f11"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["Pipeline(steps=[('scaler', MinMaxScaler()),\n","                ('sgd',\n","                 SGDClassifier(alpha=0.001, class_weight='balanced',\n","                               max_iter=675.0, penalty='l1', random_state=0))])"]},"metadata":{},"execution_count":21}]},{"cell_type":"code","source":["cv.best_params_"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"BKllKACnzQ-r","executionInfo":{"status":"ok","timestamp":1665532526485,"user_tz":180,"elapsed":4,"user":{"displayName":"Agustina Conrrero","userId":"09961504917594344859"}},"outputId":"eff664c2-3f3b-4ed8-c1c3-34bf59fd82b1"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'sgd__alpha': 0.001, 'sgd__loss': 'hinge', 'sgd__penalty': 'l1'}"]},"metadata":{},"execution_count":22}]},{"cell_type":"code","source":["cv.best_score_"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"_VJdQl79zVPD","executionInfo":{"status":"ok","timestamp":1665532528426,"user_tz":180,"elapsed":278,"user":{"displayName":"Agustina Conrrero","userId":"09961504917594344859"}},"outputId":"e5b08f28-2fde-4a8b-f3f1-26a638b76ecf"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0.7171585685325774"]},"metadata":{},"execution_count":23}]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Ywx3OhxSTULr","executionInfo":{"status":"ok","timestamp":1665532529006,"user_tz":180,"elapsed":4,"user":{"displayName":"Agustina Conrrero","userId":"09961504917594344859"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"a7c04724-c62f-4b63-982e-699688e5eb92"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["Pipeline(steps=[('minmaxscaler', MinMaxScaler()),\n","                ('sgdclassifier',\n","                 SGDClassifier(alpha=0.001, class_weight='balanced',\n","                               max_iter=675.0, penalty='l1', random_state=0))])"]},"metadata":{},"execution_count":24}],"source":["scaler=MinMaxScaler()\n","\n","sgd=SGDClassifier(alpha=0.001, loss='hinge', penalty='l1',class_weight='balanced',\n","              random_state=0,max_iter=max_iter)\n","\n","\n","best_model=make_pipeline(scaler,sgd)\n","\n","best_model.fit(X_train, y_train)"]},{"cell_type":"code","source":["y_train_pred_best= best_model.predict(X_train)\n","y_test_pred_best= best_model.predict(X_test)\n","\n","print(\"ENTRENAMIENTO\")\n","print(classification_report(y_train, y_train_pred_best))\n","\n","print(\"TESTEO\")\n","print(classification_report(y_test, y_test_pred_best))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"4GE50NkTzfDl","executionInfo":{"status":"ok","timestamp":1665532530579,"user_tz":180,"elapsed":270,"user":{"displayName":"Agustina Conrrero","userId":"09961504917594344859"}},"outputId":"0e7d8875-18f1-416b-ca43-652972f4d260"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["ENTRENAMIENTO\n","              precision    recall  f1-score   support\n","\n","           0       0.91      0.84      0.88      1232\n","           1       0.44      0.60      0.51       251\n","\n","    accuracy                           0.80      1483\n","   macro avg       0.67      0.72      0.69      1483\n","weighted avg       0.83      0.80      0.81      1483\n","\n","TESTEO\n","              precision    recall  f1-score   support\n","\n","           0       0.93      0.87      0.90       313\n","           1       0.47      0.66      0.55        58\n","\n","    accuracy                           0.83       371\n","   macro avg       0.70      0.76      0.72       371\n","weighted avg       0.86      0.83      0.84       371\n","\n"]}]},{"cell_type":"code","source":["cm=confusion_matrix(y_test,y_test_pred_best)\n","\n","sns.heatmap(cm, annot=True)\n","\n","plt.title(\"Confusion matrix\")   \n","plt.show()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":281},"id":"PZQpGsxnzh4-","executionInfo":{"status":"ok","timestamp":1665532532677,"user_tz":180,"elapsed":6,"user":{"displayName":"Agustina Conrrero","userId":"09961504917594344859"}},"outputId":"63b1784a-a505-4beb-b533-822efb23b758"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 2 Axes>"],"image/png":"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\n"},"metadata":{"needs_background":"light"}}]},{"cell_type":"markdown","source":["Se reajustaron 70 modelos diferentes e identificamos al mejor modelo al que cumplia con los parámetros: \n","\n","- alpha': 0.001\n","\n","- 'penalty': 'l1'\n","\n","- 'loss': 'hinge'"],"metadata":{"id":"prnzEVFDzmdR"}},{"cell_type":"markdown","source":["En comparación al modelo con parámetros establecidos por default, pareciera que este modelo predice mejor a la clase minoritaria. \n","\n","De todas maneras, creemos que se deberían reducir los falsos negativos. Pudimos observar que en un umbral del 50%, los mismos se reducen. El umbral de probabilidad se puede obtener utilizando el índice de Youden a través de las curvas ROC. "],"metadata":{"id":"BRZQHshj0C1a"}},{"cell_type":"code","source":["def find_cutoff_roc(target, predicted):\n","\n","    fpr, tpr, threshold = roc_curve(target, predicted)\n","    i = np.arange(len(tpr)) \n","    roc = pd.DataFrame({'tpr': pd.Series(tpr),\n","                        'fpr' : pd.Series(fpr),\n","                        'tf' : pd.Series(tpr-(1-fpr), index=i), 'threshold' : pd.Series(threshold, index=i)})\n","    roc_t=roc.iloc[(roc.tf-0).abs().argsort()][:1]\n","\n","    return list(roc_t['threshold']),roc"],"metadata":{"id":"rkD0cQdl3d6d"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["threshold,roc_df=find_cutoff_roc(y_test, best_model.decision_function(X_test))\n","print(\"El umbral óptimo es : {:.6f}\".format(threshold[0]))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ath-BsQd3V2L","executionInfo":{"status":"ok","timestamp":1665532540205,"user_tz":180,"elapsed":265,"user":{"displayName":"Agustina Conrrero","userId":"09961504917594344859"}},"outputId":"ef1164a2-61b0-46b1-b8ea-2775d7d6a01b"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["El umbral óptimo es : -0.208925\n"]}]},{"cell_type":"code","source":["roc_df[roc_df.threshold==threshold[0]]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":81},"id":"CupfP17w3tw-","executionInfo":{"status":"ok","timestamp":1665532540493,"user_tz":180,"elapsed":4,"user":{"displayName":"Agustina Conrrero","userId":"09961504917594344859"}},"outputId":"a52e2e60-11bc-49f8-803a-03bbf33e40aa"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["         tpr       fpr        tf  threshold\n","46  0.775862  0.226837  0.002699  -0.208925"],"text/html":["\n","  <div id=\"df-34aced2f-1acd-4bb5-b5a8-1777db77231a\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>tpr</th>\n","      <th>fpr</th>\n","      <th>tf</th>\n","      <th>threshold</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>46</th>\n","      <td>0.775862</td>\n","      <td>0.226837</td>\n","      <td>0.002699</td>\n","      <td>-0.208925</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-34aced2f-1acd-4bb5-b5a8-1777db77231a')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-34aced2f-1acd-4bb5-b5a8-1777db77231a button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-34aced2f-1acd-4bb5-b5a8-1777db77231a');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":30}]},{"cell_type":"code","source":["def plot_roc_auc(actual, preds,optimal_tpr,optimal_fpr):\n","    \n","    fig,axs=plt.subplots(nrows=1,ncols=2,sharex=False,figsize=(10,5))\n","    \n","    fpr, tpr, thresholds = roc_curve(actual, preds)\n","    roc_auc = auc(fpr, tpr)\n","    axs[0].plot(fpr, tpr,'r')\n","    axs[0].plot([0,1],[0,1],'b')\n","    axs[0].set_title('AUC: {}'.format(roc_auc))\n","    axs[0].set_xlabel('FPR')\n","    axs[0].set_ylabel('TPR')\n","    axs[0].hlines(y=optimal_tpr,color='g',xmin=0,xmax=1,linestyles='dotted')\n","    axs[0].vlines(x=optimal_fpr,color='g',ymin=0,ymax=1,linestyles='dotted')\n","    \n","    i = np.arange(len(tpr)) # index for df\n","    roc = pd.DataFrame({'fpr' : pd.Series(fpr, index=i),'tpr' : pd.Series(tpr, index = i), '1-fpr' : pd.Series(1-fpr, index = i), 'tf' : pd.Series(tpr - (1-fpr), index = i), 'thresholds' : pd.Series(thresholds, index = i)})\n","    roc.iloc[(roc.tf-0).abs().argsort()[:1]]\n","    \n","    # Plot tpr vs 1-fpr\n","    axs[1].plot(roc['tpr'])\n","    axs[1].plot(roc['1-fpr'], color = 'red')\n","    axs[1].set_xlabel('1-FPR')\n","    axs[1].set_ylabel('TPR')\n","    axs[1].set_title('Receiver operating characteristic')\n","    axs[1].set_xticklabels([])\n","    plt.show()"],"metadata":{"id":"BIQcKNDp30FO"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["plot_roc_auc(y_test,  best_model.decision_function(X_test) ,0.775862,0.226837)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":350},"id":"zGoekNIa3uzA","executionInfo":{"status":"ok","timestamp":1665532540950,"user_tz":180,"elapsed":460,"user":{"displayName":"Agustina Conrrero","userId":"09961504917594344859"}},"outputId":"d569b7bc-bec3-4995-ff4c-c9ce1ee25860"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["<Figure size 720x360 with 2 Axes>"],"image/png":"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\n"},"metadata":{"needs_background":"light"}}]},{"cell_type":"code","source":["X_test_predicciones=X_test.reset_index(drop=True)\n","X_test_predicciones['predicciones']=best_model.decision_function(X_test)\n","X_test_predicciones.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"L_FkKGG7350M","executionInfo":{"status":"ok","timestamp":1665532540950,"user_tz":180,"elapsed":8,"user":{"displayName":"Agustina Conrrero","userId":"09961504917594344859"}},"outputId":"2d99d1e7-acdc-4e0a-c982-f22c9be7d069"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["    LOAN  MORTDUE     VALUE   YOJ  DEROG  DELINQ       CLAGE  NINQ  CLNO  \\\n","0   4200  50216.0   58541.0  19.0    0.0     0.0  209.871302   0.0  19.0   \n","1  19300  50554.0   76140.0   9.0    2.0     0.0   78.276625   3.0  27.0   \n","2  13000  78766.0  106450.0   6.0    0.0     0.0  107.951312   0.0  26.0   \n","3  11800  67678.0  108092.0  13.0    0.0     7.0  126.658232   0.0  36.0   \n","4  87500  55938.0   86794.0  15.0    0.0     0.0  223.881040   0.0  16.0   \n","\n","     DEBTINC  predicciones  \n","0  20.208033     -1.641663  \n","1  36.026904      1.248928  \n","2  24.870994     -1.024786  \n","3  37.162690      4.027847  \n","4  36.753653     -1.536803  "],"text/html":["\n","  <div id=\"df-ad9dc746-9840-452f-8854-68bb7a198eb0\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>LOAN</th>\n","      <th>MORTDUE</th>\n","      <th>VALUE</th>\n","      <th>YOJ</th>\n","      <th>DEROG</th>\n","      <th>DELINQ</th>\n","      <th>CLAGE</th>\n","      <th>NINQ</th>\n","      <th>CLNO</th>\n","      <th>DEBTINC</th>\n","      <th>predicciones</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>4200</td>\n","      <td>50216.0</td>\n","      <td>58541.0</td>\n","      <td>19.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>209.871302</td>\n","      <td>0.0</td>\n","      <td>19.0</td>\n","      <td>20.208033</td>\n","      <td>-1.641663</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>19300</td>\n","      <td>50554.0</td>\n","      <td>76140.0</td>\n","      <td>9.0</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>78.276625</td>\n","      <td>3.0</td>\n","      <td>27.0</td>\n","      <td>36.026904</td>\n","      <td>1.248928</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>13000</td>\n","      <td>78766.0</td>\n","      <td>106450.0</td>\n","      <td>6.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>107.951312</td>\n","      <td>0.0</td>\n","      <td>26.0</td>\n","      <td>24.870994</td>\n","      <td>-1.024786</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>11800</td>\n","      <td>67678.0</td>\n","      <td>108092.0</td>\n","      <td>13.0</td>\n","      <td>0.0</td>\n","      <td>7.0</td>\n","      <td>126.658232</td>\n","      <td>0.0</td>\n","      <td>36.0</td>\n","      <td>37.162690</td>\n","      <td>4.027847</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>87500</td>\n","      <td>55938.0</td>\n","      <td>86794.0</td>\n","      <td>15.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>223.881040</td>\n","      <td>0.0</td>\n","      <td>16.0</td>\n","      <td>36.753653</td>\n","      <td>-1.536803</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-ad9dc746-9840-452f-8854-68bb7a198eb0')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-ad9dc746-9840-452f-8854-68bb7a198eb0 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-ad9dc746-9840-452f-8854-68bb7a198eb0');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":33}]},{"cell_type":"code","source":["X_test_predicciones['prediccion']=X_test_predicciones['predicciones'].apply(lambda x: 1 if x>threshold[0] else 0 )\n","X_test_predicciones"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"V0DMAR6n37W-","executionInfo":{"status":"ok","timestamp":1665532540951,"user_tz":180,"elapsed":8,"user":{"displayName":"Agustina Conrrero","userId":"09961504917594344859"}},"outputId":"c1fdd443-e0a1-438c-8b01-eb4b53caf0de"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["      LOAN  MORTDUE     VALUE   YOJ  DEROG  DELINQ       CLAGE  NINQ  CLNO  \\\n","0     4200  50216.0   58541.0  19.0    0.0     0.0  209.871302   0.0  19.0   \n","1    19300  50554.0   76140.0   9.0    2.0     0.0   78.276625   3.0  27.0   \n","2    13000  78766.0  106450.0   6.0    0.0     0.0  107.951312   0.0  26.0   \n","3    11800  67678.0  108092.0  13.0    0.0     7.0  126.658232   0.0  36.0   \n","4    87500  55938.0   86794.0  15.0    0.0     0.0  223.881040   0.0  16.0   \n","..     ...      ...       ...   ...    ...     ...         ...   ...   ...   \n","366  79100  23553.0  103807.0  25.0    0.0     1.0  142.193458   0.0  13.0   \n","367  16300  79087.0  102921.0  23.0    0.0     0.0  256.253084   0.0  45.0   \n","368  26900  72848.0  101736.0  10.0    0.0     0.0  131.409634   0.0  21.0   \n","369  13000  80587.0  110064.0   6.0    0.0     0.0   85.009197   1.0  13.0   \n","370  14100  52302.0   63589.0   6.0    0.0     0.0  130.342467   4.0   8.0   \n","\n","       DEBTINC  predicciones  prediccion  \n","0    20.208033     -1.641663           0  \n","1    36.026904      1.248928           1  \n","2    24.870994     -1.024786           0  \n","3    37.162690      4.027847           1  \n","4    36.753653     -1.536803           0  \n","..         ...           ...         ...  \n","366  31.469937     -0.768735           0  \n","367  36.987086     -1.378780           0  \n","368  36.369027     -0.615816           0  \n","369  33.990040     -0.180998           1  \n","370  34.792832      0.036356           1  \n","\n","[371 rows x 12 columns]"],"text/html":["\n","  <div id=\"df-fc7104e4-17a6-42e5-b14f-7493efacf3d1\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>LOAN</th>\n","      <th>MORTDUE</th>\n","      <th>VALUE</th>\n","      <th>YOJ</th>\n","      <th>DEROG</th>\n","      <th>DELINQ</th>\n","      <th>CLAGE</th>\n","      <th>NINQ</th>\n","      <th>CLNO</th>\n","      <th>DEBTINC</th>\n","      <th>predicciones</th>\n","      <th>prediccion</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>4200</td>\n","      <td>50216.0</td>\n","      <td>58541.0</td>\n","      <td>19.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>209.871302</td>\n","      <td>0.0</td>\n","      <td>19.0</td>\n","      <td>20.208033</td>\n","      <td>-1.641663</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>19300</td>\n","      <td>50554.0</td>\n","      <td>76140.0</td>\n","      <td>9.0</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>78.276625</td>\n","      <td>3.0</td>\n","      <td>27.0</td>\n","      <td>36.026904</td>\n","      <td>1.248928</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>13000</td>\n","      <td>78766.0</td>\n","      <td>106450.0</td>\n","      <td>6.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>107.951312</td>\n","      <td>0.0</td>\n","      <td>26.0</td>\n","      <td>24.870994</td>\n","      <td>-1.024786</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>11800</td>\n","      <td>67678.0</td>\n","      <td>108092.0</td>\n","      <td>13.0</td>\n","      <td>0.0</td>\n","      <td>7.0</td>\n","      <td>126.658232</td>\n","      <td>0.0</td>\n","      <td>36.0</td>\n","      <td>37.162690</td>\n","      <td>4.027847</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>87500</td>\n","      <td>55938.0</td>\n","      <td>86794.0</td>\n","      <td>15.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>223.881040</td>\n","      <td>0.0</td>\n","      <td>16.0</td>\n","      <td>36.753653</td>\n","      <td>-1.536803</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>366</th>\n","      <td>79100</td>\n","      <td>23553.0</td>\n","      <td>103807.0</td>\n","      <td>25.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>142.193458</td>\n","      <td>0.0</td>\n","      <td>13.0</td>\n","      <td>31.469937</td>\n","      <td>-0.768735</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>367</th>\n","      <td>16300</td>\n","      <td>79087.0</td>\n","      <td>102921.0</td>\n","      <td>23.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>256.253084</td>\n","      <td>0.0</td>\n","      <td>45.0</td>\n","      <td>36.987086</td>\n","      <td>-1.378780</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>368</th>\n","      <td>26900</td>\n","      <td>72848.0</td>\n","      <td>101736.0</td>\n","      <td>10.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>131.409634</td>\n","      <td>0.0</td>\n","      <td>21.0</td>\n","      <td>36.369027</td>\n","      <td>-0.615816</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>369</th>\n","      <td>13000</td>\n","      <td>80587.0</td>\n","      <td>110064.0</td>\n","      <td>6.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>85.009197</td>\n","      <td>1.0</td>\n","      <td>13.0</td>\n","      <td>33.990040</td>\n","      <td>-0.180998</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>370</th>\n","      <td>14100</td>\n","      <td>52302.0</td>\n","      <td>63589.0</td>\n","      <td>6.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>130.342467</td>\n","      <td>4.0</td>\n","      <td>8.0</td>\n","      <td>34.792832</td>\n","      <td>0.036356</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>371 rows × 12 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-fc7104e4-17a6-42e5-b14f-7493efacf3d1')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-fc7104e4-17a6-42e5-b14f-7493efacf3d1 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-fc7104e4-17a6-42e5-b14f-7493efacf3d1');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":34}]},{"cell_type":"code","source":["cm=confusion_matrix(y_test,X_test_predicciones.prediccion)\n","\n","sns.heatmap(cm, annot=True)\n","\n","plt.title(\"Confusion matrix\")   \n","plt.show()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":281},"id":"p0G2gohC38yC","executionInfo":{"status":"ok","timestamp":1665532541329,"user_tz":180,"elapsed":385,"user":{"displayName":"Agustina Conrrero","userId":"09961504917594344859"}},"outputId":"275247d1-bf19-4d4d-92a5-469ae9c442c0"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 2 Axes>"],"image/png":"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\n"},"metadata":{"needs_background":"light"}}]},{"cell_type":"code","source":["print(classification_report(y_test, X_test_predicciones.prediccion))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"RzABLHlo3-kV","executionInfo":{"status":"ok","timestamp":1665532541330,"user_tz":180,"elapsed":12,"user":{"displayName":"Agustina Conrrero","userId":"09961504917594344859"}},"outputId":"861fd6df-e58d-4445-fb18-f66c109d472c"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["              precision    recall  f1-score   support\n","\n","           0       0.95      0.77      0.85       313\n","           1       0.38      0.76      0.51        58\n","\n","    accuracy                           0.77       371\n","   macro avg       0.66      0.77      0.68       371\n","weighted avg       0.86      0.77      0.80       371\n","\n"]}]},{"cell_type":"markdown","source":["Debido que quisimos disminuir el número de Falsos Negativos, se disminuyó la precisión del model debido al aumento del recall. "],"metadata":{"id":"Q8NRdg5j4BYB"}},{"cell_type":"markdown","metadata":{"id":"7jvR-LPoXrns"},"source":["## Ejercicio 3: Árboles de Decisión\n","\n","En este ejercicio se entrenarán árboles de decisión para predecir la variable objetivo.\n","\n","Para ello, deberán utilizar la clase DecisionTreeClassifier de scikit-learn.\n","\n","Documentación:\n","- https://scikit-learn.org/stable/modules/tree.html\n","  - https://scikit-learn.org/stable/modules/tree.html#tips-on-practical-use\n","- https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html\n","- https://scikit-learn.org/stable/auto_examples/tree/plot_unveil_tree_structure.html"]},{"cell_type":"markdown","metadata":{"id":"IOkTfK-eXrnu"},"source":["### Ejercicio 3.1: DecisionTreeClassifier con hiperparámetros por defecto\n","\n","Entrenar y evaluar el clasificador DecisionTreeClassifier usando los valores por omisión de scikit-learn para todos los parámetros. Únicamente **fijar la semilla aleatoria** para hacer repetible el experimento.\n","\n","Evaluar sobre el conjunto de **entrenamiento** y sobre el conjunto de **evaluación**, reportando:\n","- Accuracy\n","- Precision\n","- Recall\n","- F1\n","- matriz de confusión\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"0qEtM1Y3TULu","executionInfo":{"status":"ok","timestamp":1665532541331,"user_tz":180,"elapsed":11,"user":{"displayName":"Agustina Conrrero","userId":"09961504917594344859"}},"outputId":"06ae8109-ece3-4502-e4b0-ea03860b48dd"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["DecisionTreeClassifier(random_state=0)"]},"metadata":{},"execution_count":37}],"source":["model=DecisionTreeClassifier(random_state=0) \n","model.fit(X_train, y_train)"]},{"cell_type":"code","source":["y_train_pred= model.predict(X_train)\n","y_test_pred=model.predict(X_test)\n","\n","print(\"ENTRENAMIENTO\")\n","print(classification_report(y_train, y_train_pred))\n","\n","print(\"TESTEO\")\n","print(classification_report(y_test, y_test_pred))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"O91-XmzEzUpz","executionInfo":{"status":"ok","timestamp":1665532541331,"user_tz":180,"elapsed":9,"user":{"displayName":"Agustina Conrrero","userId":"09961504917594344859"}},"outputId":"4c73bc99-f654-444e-f965-4cc7337db80f"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["ENTRENAMIENTO\n","              precision    recall  f1-score   support\n","\n","           0       1.00      1.00      1.00      1232\n","           1       1.00      1.00      1.00       251\n","\n","    accuracy                           1.00      1483\n","   macro avg       1.00      1.00      1.00      1483\n","weighted avg       1.00      1.00      1.00      1483\n","\n","TESTEO\n","              precision    recall  f1-score   support\n","\n","           0       0.93      0.93      0.93       313\n","           1       0.62      0.64      0.63        58\n","\n","    accuracy                           0.88       371\n","   macro avg       0.77      0.78      0.78       371\n","weighted avg       0.88      0.88      0.88       371\n","\n"]}]},{"cell_type":"code","source":["cm=confusion_matrix(y_test,y_test_pred)\n","\n","sns.heatmap(cm, annot=True)\n","\n","plt.title(\"Confusion matrix\")   \n","plt.show()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":281},"id":"mHAxSzBAzYpV","executionInfo":{"status":"ok","timestamp":1665532541331,"user_tz":180,"elapsed":8,"user":{"displayName":"Agustina Conrrero","userId":"09961504917594344859"}},"outputId":"458aa56f-6874-4525-8f10-6c94ca5f103b"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 2 Axes>"],"image/png":"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\n"},"metadata":{"needs_background":"light"}}]},{"cell_type":"markdown","metadata":{"id":"t5uj0E45Xrny"},"source":["### Ejercicio 3.2: Ajuste de Hiperparámetros\n","\n","Seleccionar valores para los hiperparámetros principales del DecisionTreeClassifier. Como mínimo, probar diferentes criterios de partición (criterion), profundidad máxima del árbol (max_depth), y cantidad mínima de samples por hoja (min_samples_leaf).\n","\n","Para ello, usar grid-search y 5-fold cross-validation sobre el conjunto de entrenamiento para explorar muchas combinaciones posibles de valores.\n","\n","Reportar accuracy promedio y varianza para todas las configuraciones.\n","\n","Para la mejor configuración encontrada, evaluar sobre el conjunto de **entrenamiento** y sobre el conjunto de **evaluación**, reportando:\n","- Accuracy\n","- Precision\n","- Recall\n","- F1\n","- matriz de confusión\n","\n","\n","Documentación:\n","- https://scikit-learn.org/stable/modules/grid_search.html\n","- https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html"]},{"cell_type":"code","source":["param_grid = {\n","    \"criterion\": [\"gini\", \"entropy\"],\n","    'max_depth': [2,3,4,5,10,15,20,25,30],\n","    \"min_samples_leaf\": [2,3,4,5,10,15,20,25,30],\n","    \"min_samples_split\": [2,3,4,5,6,7,8,9,10,15,20,25,30]\n","}"],"metadata":{"id":"iOcLNTbs0uIC"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"1etY6TFvTULw","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1665532637803,"user_tz":180,"elapsed":96479,"user":{"displayName":"Agustina Conrrero","userId":"09961504917594344859"}},"outputId":"6692290f-dfa8-4a25-daef-64e47372cb23"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["GridSearchCV(cv=5,\n","             estimator=DecisionTreeClassifier(class_weight='balanced',\n","                                              random_state=0),\n","             param_grid={'criterion': ['gini', 'entropy'],\n","                         'max_depth': [2, 3, 4, 5, 10, 15, 20, 25, 30],\n","                         'min_samples_leaf': [2, 3, 4, 5, 10, 15, 20, 25, 30],\n","                         'min_samples_split': [2, 3, 4, 5, 6, 7, 8, 9, 10, 15,\n","                                               20, 25, 30]},\n","             scoring='balanced_accuracy')"]},"metadata":{},"execution_count":41}],"source":["model = DecisionTreeClassifier(random_state=0,class_weight='balanced')\n","\n","cv = GridSearchCV(model, param_grid, scoring='balanced_accuracy', cv=5)\n","cv.fit(X_train, y_train)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"nTaAaFirTULw"},"outputs":[],"source":["results = cv.cv_results_"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"1Zq_5UcYTULw","colab":{"base_uri":"https://localhost:8080/","height":990},"executionInfo":{"status":"ok","timestamp":1665532637804,"user_tz":180,"elapsed":17,"user":{"displayName":"Agustina Conrrero","userId":"09961504917594344859"}},"outputId":"9939a0c7-6f72-420e-d881-8f81e8c2c1ac"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["     param_criterion param_max_depth param_min_samples_leaf  \\\n","476             gini              10                      2   \n","475             gini              10                      2   \n","710             gini              20                      2   \n","593             gini              15                      2   \n","827             gini              25                      2   \n","944             gini              30                      2   \n","471             gini              10                      2   \n","936             gini              30                      2   \n","937             gini              30                      2   \n","938             gini              30                      2   \n","820             gini              25                      2   \n","821             gini              25                      2   \n","586             gini              15                      2   \n","587             gini              15                      2   \n","585             gini              15                      2   \n","702             gini              20                      2   \n","703             gini              20                      2   \n","704             gini              20                      2   \n","819             gini              25                      2   \n","591             gini              15                      2   \n","942             gini              30                      2   \n","825             gini              25                      2   \n","708             gini              20                      2   \n","2017         entropy              30                      4   \n","2016         entropy              30                      4   \n","2018         entropy              30                      4   \n","2019         entropy              30                      4   \n","2020         entropy              30                      4   \n","2021         entropy              30                      4   \n","1785         entropy              20                      4   \n","\n","     param_min_samples_split  mean_test_score  std_test_score  rank_test_score  \n","476                       10         0.748965        0.050394                1  \n","475                        9         0.748965        0.051703                1  \n","710                       10         0.746243        0.042647                3  \n","593                       10         0.746243        0.042647                3  \n","827                       10         0.746243        0.042647                3  \n","944                       10         0.746243        0.042647                3  \n","471                        5         0.745836        0.047590                7  \n","936                        2         0.745675        0.043632                8  \n","937                        3         0.745675        0.043632                8  \n","938                        4         0.745675        0.043632                8  \n","820                        3         0.745675        0.043632                8  \n","821                        4         0.745675        0.043632                8  \n","586                        3         0.745675        0.043632                8  \n","587                        4         0.745675        0.043632                8  \n","585                        2         0.745675        0.043632                8  \n","702                        2         0.745675        0.043632                8  \n","703                        3         0.745675        0.043632                8  \n","704                        4         0.745675        0.043632                8  \n","819                        2         0.745675        0.043632                8  \n","591                        8         0.745108        0.040509               20  \n","942                        8         0.745108        0.040509               20  \n","825                        8         0.745108        0.040509               20  \n","708                        8         0.745108        0.040509               20  \n","2017                       4         0.744730        0.023442               24  \n","2016                       3         0.744730        0.023442               24  \n","2018                       5         0.744730        0.023442               24  \n","2019                       6         0.744730        0.023442               24  \n","2020                       7         0.744730        0.023442               24  \n","2021                       8         0.744730        0.023442               24  \n","1785                       6         0.744730        0.023442               24  "],"text/html":["\n","  <div id=\"df-e4405586-ad52-4a02-a68a-ff03ede2b2c7\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>param_criterion</th>\n","      <th>param_max_depth</th>\n","      <th>param_min_samples_leaf</th>\n","      <th>param_min_samples_split</th>\n","      <th>mean_test_score</th>\n","      <th>std_test_score</th>\n","      <th>rank_test_score</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>476</th>\n","      <td>gini</td>\n","      <td>10</td>\n","      <td>2</td>\n","      <td>10</td>\n","      <td>0.748965</td>\n","      <td>0.050394</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>475</th>\n","      <td>gini</td>\n","      <td>10</td>\n","      <td>2</td>\n","      <td>9</td>\n","      <td>0.748965</td>\n","      <td>0.051703</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>710</th>\n","      <td>gini</td>\n","      <td>20</td>\n","      <td>2</td>\n","      <td>10</td>\n","      <td>0.746243</td>\n","      <td>0.042647</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>593</th>\n","      <td>gini</td>\n","      <td>15</td>\n","      <td>2</td>\n","      <td>10</td>\n","      <td>0.746243</td>\n","      <td>0.042647</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>827</th>\n","      <td>gini</td>\n","      <td>25</td>\n","      <td>2</td>\n","      <td>10</td>\n","      <td>0.746243</td>\n","      <td>0.042647</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>944</th>\n","      <td>gini</td>\n","      <td>30</td>\n","      <td>2</td>\n","      <td>10</td>\n","      <td>0.746243</td>\n","      <td>0.042647</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>471</th>\n","      <td>gini</td>\n","      <td>10</td>\n","      <td>2</td>\n","      <td>5</td>\n","      <td>0.745836</td>\n","      <td>0.047590</td>\n","      <td>7</td>\n","    </tr>\n","    <tr>\n","      <th>936</th>\n","      <td>gini</td>\n","      <td>30</td>\n","      <td>2</td>\n","      <td>2</td>\n","      <td>0.745675</td>\n","      <td>0.043632</td>\n","      <td>8</td>\n","    </tr>\n","    <tr>\n","      <th>937</th>\n","      <td>gini</td>\n","      <td>30</td>\n","      <td>2</td>\n","      <td>3</td>\n","      <td>0.745675</td>\n","      <td>0.043632</td>\n","      <td>8</td>\n","    </tr>\n","    <tr>\n","      <th>938</th>\n","      <td>gini</td>\n","      <td>30</td>\n","      <td>2</td>\n","      <td>4</td>\n","      <td>0.745675</td>\n","      <td>0.043632</td>\n","      <td>8</td>\n","    </tr>\n","    <tr>\n","      <th>820</th>\n","      <td>gini</td>\n","      <td>25</td>\n","      <td>2</td>\n","      <td>3</td>\n","      <td>0.745675</td>\n","      <td>0.043632</td>\n","      <td>8</td>\n","    </tr>\n","    <tr>\n","      <th>821</th>\n","      <td>gini</td>\n","      <td>25</td>\n","      <td>2</td>\n","      <td>4</td>\n","      <td>0.745675</td>\n","      <td>0.043632</td>\n","      <td>8</td>\n","    </tr>\n","    <tr>\n","      <th>586</th>\n","      <td>gini</td>\n","      <td>15</td>\n","      <td>2</td>\n","      <td>3</td>\n","      <td>0.745675</td>\n","      <td>0.043632</td>\n","      <td>8</td>\n","    </tr>\n","    <tr>\n","      <th>587</th>\n","      <td>gini</td>\n","      <td>15</td>\n","      <td>2</td>\n","      <td>4</td>\n","      <td>0.745675</td>\n","      <td>0.043632</td>\n","      <td>8</td>\n","    </tr>\n","    <tr>\n","      <th>585</th>\n","      <td>gini</td>\n","      <td>15</td>\n","      <td>2</td>\n","      <td>2</td>\n","      <td>0.745675</td>\n","      <td>0.043632</td>\n","      <td>8</td>\n","    </tr>\n","    <tr>\n","      <th>702</th>\n","      <td>gini</td>\n","      <td>20</td>\n","      <td>2</td>\n","      <td>2</td>\n","      <td>0.745675</td>\n","      <td>0.043632</td>\n","      <td>8</td>\n","    </tr>\n","    <tr>\n","      <th>703</th>\n","      <td>gini</td>\n","      <td>20</td>\n","      <td>2</td>\n","      <td>3</td>\n","      <td>0.745675</td>\n","      <td>0.043632</td>\n","      <td>8</td>\n","    </tr>\n","    <tr>\n","      <th>704</th>\n","      <td>gini</td>\n","      <td>20</td>\n","      <td>2</td>\n","      <td>4</td>\n","      <td>0.745675</td>\n","      <td>0.043632</td>\n","      <td>8</td>\n","    </tr>\n","    <tr>\n","      <th>819</th>\n","      <td>gini</td>\n","      <td>25</td>\n","      <td>2</td>\n","      <td>2</td>\n","      <td>0.745675</td>\n","      <td>0.043632</td>\n","      <td>8</td>\n","    </tr>\n","    <tr>\n","      <th>591</th>\n","      <td>gini</td>\n","      <td>15</td>\n","      <td>2</td>\n","      <td>8</td>\n","      <td>0.745108</td>\n","      <td>0.040509</td>\n","      <td>20</td>\n","    </tr>\n","    <tr>\n","      <th>942</th>\n","      <td>gini</td>\n","      <td>30</td>\n","      <td>2</td>\n","      <td>8</td>\n","      <td>0.745108</td>\n","      <td>0.040509</td>\n","      <td>20</td>\n","    </tr>\n","    <tr>\n","      <th>825</th>\n","      <td>gini</td>\n","      <td>25</td>\n","      <td>2</td>\n","      <td>8</td>\n","      <td>0.745108</td>\n","      <td>0.040509</td>\n","      <td>20</td>\n","    </tr>\n","    <tr>\n","      <th>708</th>\n","      <td>gini</td>\n","      <td>20</td>\n","      <td>2</td>\n","      <td>8</td>\n","      <td>0.745108</td>\n","      <td>0.040509</td>\n","      <td>20</td>\n","    </tr>\n","    <tr>\n","      <th>2017</th>\n","      <td>entropy</td>\n","      <td>30</td>\n","      <td>4</td>\n","      <td>4</td>\n","      <td>0.744730</td>\n","      <td>0.023442</td>\n","      <td>24</td>\n","    </tr>\n","    <tr>\n","      <th>2016</th>\n","      <td>entropy</td>\n","      <td>30</td>\n","      <td>4</td>\n","      <td>3</td>\n","      <td>0.744730</td>\n","      <td>0.023442</td>\n","      <td>24</td>\n","    </tr>\n","    <tr>\n","      <th>2018</th>\n","      <td>entropy</td>\n","      <td>30</td>\n","      <td>4</td>\n","      <td>5</td>\n","      <td>0.744730</td>\n","      <td>0.023442</td>\n","      <td>24</td>\n","    </tr>\n","    <tr>\n","      <th>2019</th>\n","      <td>entropy</td>\n","      <td>30</td>\n","      <td>4</td>\n","      <td>6</td>\n","      <td>0.744730</td>\n","      <td>0.023442</td>\n","      <td>24</td>\n","    </tr>\n","    <tr>\n","      <th>2020</th>\n","      <td>entropy</td>\n","      <td>30</td>\n","      <td>4</td>\n","      <td>7</td>\n","      <td>0.744730</td>\n","      <td>0.023442</td>\n","      <td>24</td>\n","    </tr>\n","    <tr>\n","      <th>2021</th>\n","      <td>entropy</td>\n","      <td>30</td>\n","      <td>4</td>\n","      <td>8</td>\n","      <td>0.744730</td>\n","      <td>0.023442</td>\n","      <td>24</td>\n","    </tr>\n","    <tr>\n","      <th>1785</th>\n","      <td>entropy</td>\n","      <td>20</td>\n","      <td>4</td>\n","      <td>6</td>\n","      <td>0.744730</td>\n","      <td>0.023442</td>\n","      <td>24</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-e4405586-ad52-4a02-a68a-ff03ede2b2c7')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-e4405586-ad52-4a02-a68a-ff03ede2b2c7 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-e4405586-ad52-4a02-a68a-ff03ede2b2c7');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":43}],"source":["df = pd.DataFrame(results)\n","df[['param_criterion', 'param_max_depth', \"param_min_samples_leaf\",\"param_min_samples_split\",'mean_test_score', 'std_test_score', 'rank_test_score']].sort_values('rank_test_score')[:30]"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"oF5tYFOLTULw","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1665532637804,"user_tz":180,"elapsed":15,"user":{"displayName":"Agustina Conrrero","userId":"09961504917594344859"}},"outputId":"47f254f0-0b4e-4d8d-e8e6-23629a9427dd"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["DecisionTreeClassifier(class_weight='balanced', max_depth=10,\n","                       min_samples_leaf=2, min_samples_split=9, random_state=0)"]},"metadata":{},"execution_count":44}],"source":["cv.best_estimator_"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"0dZcIt__TULw","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1665532637805,"user_tz":180,"elapsed":12,"user":{"displayName":"Agustina Conrrero","userId":"09961504917594344859"}},"outputId":"800737b0-3add-467f-ef36-e05b53ce0fa9"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'criterion': 'gini',\n"," 'max_depth': 10,\n"," 'min_samples_leaf': 2,\n"," 'min_samples_split': 9}"]},"metadata":{},"execution_count":45}],"source":["cv.best_params_"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"sY7uqlIBTULx","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1665532637805,"user_tz":180,"elapsed":10,"user":{"displayName":"Agustina Conrrero","userId":"09961504917594344859"}},"outputId":"7c1fbf19-526a-4568-e458-8eba47905c8f"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["DecisionTreeClassifier(class_weight='balanced', max_depth=15,\n","                       min_samples_leaf=2, random_state=0)"]},"metadata":{},"execution_count":46}],"source":["best_model=DecisionTreeClassifier(criterion=\"gini\", max_depth=15, min_samples_leaf=2, min_samples_split=2,random_state=0,class_weight='balanced')\n","best_model.fit(X_train, y_train)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"o8XAUvNQTULx","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1665532637805,"user_tz":180,"elapsed":9,"user":{"displayName":"Agustina Conrrero","userId":"09961504917594344859"}},"outputId":"b4459774-92f1-4138-a852-766e2114f1a2"},"outputs":[{"output_type":"stream","name":"stdout","text":["ENTRENAMIENTO\n","              precision    recall  f1-score   support\n","\n","           0       1.00      0.96      0.98      1232\n","           1       0.85      1.00      0.92       251\n","\n","    accuracy                           0.97      1483\n","   macro avg       0.93      0.98      0.95      1483\n","weighted avg       0.97      0.97      0.97      1483\n","\n","TESTEO\n","              precision    recall  f1-score   support\n","\n","           0       0.95      0.88      0.91       313\n","           1       0.54      0.74      0.62        58\n","\n","    accuracy                           0.86       371\n","   macro avg       0.74      0.81      0.77       371\n","weighted avg       0.88      0.86      0.87       371\n","\n"]}],"source":["y_train_pred_best= best_model.predict(X_train)\n","y_test_pred_best= best_model.predict(X_test)\n","\n","print(\"ENTRENAMIENTO\")\n","print(classification_report(y_train, y_train_pred_best))\n","\n","print(\"TESTEO\")\n","print(classification_report(y_test, y_test_pred_best))"]},{"cell_type":"markdown","source":["Para todos los casos, se obtuvieron mejores métricas en el entrenamiento que en el testeo, como era de esperarse. Sin embargo, consideramos que los valores obtenidos no son considerablemente diferentes, por lo que probablemente no hubo sobreajuste. "],"metadata":{"id":"AipYFVWbfYKF"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"BVr2CqOATULx","colab":{"base_uri":"https://localhost:8080/","height":281},"executionInfo":{"status":"ok","timestamp":1665532637805,"user_tz":180,"elapsed":8,"user":{"displayName":"Agustina Conrrero","userId":"09961504917594344859"}},"outputId":"540da922-6c60-4061-e629-1acafec213fe"},"outputs":[{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 2 Axes>"],"image/png":"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\n"},"metadata":{"needs_background":"light"}}],"source":["cm=confusion_matrix(y_test,y_test_pred_best)\n","\n","sns.heatmap(cm, annot=True)\n","\n","plt.title(\"Confusion matrix\")\n","plt.show()"]},{"cell_type":"markdown","source":["Si comparamos ambas matrices de confusión, podemos observar que en el segundo caso disminuyeron los (0,0) y aumentaron los true positives (1,1). Esto es importante ya que lo más relevante es poder predecir correctamente a los créditos que podrían entrar en default, lo que se vio aumentado en esta última instancia. \n"],"metadata":{"id":"5GgUpeGl2ePn"}},{"cell_type":"markdown","metadata":{"id":"iWIkH1HuTULy"},"source":[" El parámetro max_depth es quien marca la diferencia entre ambos modelos. El mismo es un indicador de complejidad en los árboles de decisión, el mismo permite que los nodos crezcan, hasta determinado valor, obteniendose nodos puros si el valor es None. "]},{"cell_type":"markdown","source":["##Conclusion\n","Como conclusion, podemos afirmar que es necesario utilizar y entrenar un modelo el cual prediga correctamente los valores positivos para aquellas personas que caen en default como primera instancia. Además, es importante que los falsos negativos y positivos no sean tan elevados, pero a la hora de poner los mismos en la balanza, es preferible que un valor que no caería en default esté catalogado al reves, a que suceda lo contrario. \n","\n","Es por ello que, con este dataset nosotros sugerimos utilizar el modelo que utiliza Random Forest ya que las métricas se vieron beneficiadas acorde a lo que estamos buscando. "],"metadata":{"id":"UX_FFFqME-m_"}}],"metadata":{"kernelspec":{"display_name":"Python 3 (ipykernel)","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.9.7"},"colab":{"provenance":[{"file_id":"1Zy4cSj_6fQx-I_R6YOtirnckv8IKUXKu","timestamp":1655330232526}],"collapsed_sections":[]}},"nbformat":4,"nbformat_minor":0}